# 7 运算符

# 7.1 算术运算符

<p><front style="background: yellow">加 （+）、减（-）、乘（*）、除（/或DIV）和取模（%或MOD）</front></p>

> 加法与减法

- 整型 `+(-)` 整型 = 整型
- 整型 `+(-) `浮点型 = 浮点型
- `+`只表示数 值相加。如果遇到非数值类型，先尝试转成数值，如果转失败，就按0计算。（补充：MySQL 中字符串拼接要使用字符串函数CONCAT()实现）

> 乘法与除法

- 一个数 `*(/)` 整数1 = 原数
- 一个数 `*(/)`浮点数1 = 浮点数，且数值与原数相等
- 一个数 `/` 整数 = 浮点数
- 一个数 `/` 另一个数 = 浮点数，且当除不尽时，保留到小数点后4位
- 一个数 `/` 0 = null

# 7.2 比较运算符

比较运算符用来对表达式左边的操作数和右边的操作数进行比较，比较的**结果为真则返回1**，比较的**结果为假则返回0**，其他情况则返回NULL。

- `=`：判断等号两边的值、字符串或表达式是否相等

  - 如果等号两遍都为**字符串**，则MySQL会按照字符串进行比较，其**比较的是每个字符串中字符的ANSI编码是否相等**。 
  - 如果等号两边都是**整数**，则MySQL会按照整数来比较两个值的大小。 
  - 如果等号两边一个是整数，一个是字符串，则MySQL会将字符串转化为数字进行比较。 
  - 如果等号两边有一个为NULL，则比较结果为NULL

- `<=>`：安全等于运算符（<=>）与等于运算符（=）的作用是相似的，**唯一的区别**是`<=>`可 以用来**对NULL进行判断**。在两个操作数均为NULL时，其返回值为1；当一个操作数为NULL 时，其返回值为0。

- `<>`或`!=`：不等于运算符。

  - 不等于运算符不能判断NULL值。如果两边的值有任意一个为NULL， 或两边都为NULL，则结果为NULL

- `IS NULL`或`ISNULL(值)`：判断一个值是否为null

- `IS NOT NULL`：判断一个值是否不为null

- `LEAST(值1, 值2, ..., 值n)`：返回最小值

- `GREATEST(值1, 值2, ..., 值n)`：返回最大值

- `BETWEEN 值1 AND 值2`：判断一个值是否在闭区间[值1, 值2]之间

- `IN(值1, 值2, ..., 值n)`：判断一个值是否是（值1, 值2, ..., 值n）中的一个值

- `NOT IN(值1, 值2, ..., 值n)`：判断一个值是否不是（值1, 值2, ..., 值n）中的任意一个值

- `LIKE`：模糊匹配

  - 常和如下通配符配合使用：
    - `%`：匹配0个或多个字符
    - `_`：匹配单个字符

- `ESCAPE`：指定一个字符去替代转义字符("`\`")

  在mysql中，如果表中某个字段存储了一些特殊符号（如%、_等），在使用`LIKE`进行模糊查询时，需要对特殊字符进行转义。

  对特殊字符的转义有两种方法：①使用转义字符`\` ②使用关键字`ESCAPE`。使用方法如下

  ```mysql
  ### 查询名字带有%字符的用户---使用转义字符'\'
  -- % 转义前，%全查
  SELECT * FROM escape_test WHERE NAME LIKE CONCAT("%", "%", "%");
  -- % 转义后 只匹配含有%的
  SELECT * FROM escape_test WHERE NAME LIKE CONCAT("%", "\%", "%");
  
  
  ### 使用关键字escape
  ### 假设存在名字为 %a 和 %_ 两个的用户
  SELECT * FROM escape_test WHERE NAME LIKE "a%_" ESCAPE "a" ;    ### 查询到的结果包含 %a %_ 
  SELECT * FROM escape_test WHERE NAME LIKE "a%a" ESCAPE "a" ;    ### 查询到的结果只有 %a 
  SELECT * FROM escape_test WHERE NAME LIKE "a%a_" ESCAPE "a" ;   ### 查询到的结果只有：%_
  ```

- `REGEXP`：使用正则表达式来匹配字符串，语法格式`字符串 regexp 正则表达式`

  常用通配符如下：

  | 通配符          | 说明                                                         | 例子    | 匹配值示例                                 |
  | --------------- | ------------------------------------------------------------ | ------- | ------------------------------------------ |
  | `^`             | 匹配以该字符后面的字符**开头**的字符串                       | ^b      | <u>b</u>ig， <u>b</u>anana                 |
  | `$`             | 匹配以该字符前面的字符**结尾**的字符串                       | st$     | te<u>st</u>， persi<u>st</u>               |
  | `.`             | 匹配任何一个**单字符**                                       | b.t     | b<u>i</u>t， b<u>a</u>t                    |
  | `*`             | 匹配**零个或多个**在它**前面**的字符。<br>如果前面没有字符，表示匹配任何数量的任何字符串 | f*n     | fn， f<u>a</u>n，f<u>aa</u>n，f<u>abc</u>n |
  | `+`             | 匹配**1次或多次**在它**前面**的字符                          | ba+     | ba，bay，bare，battle                      |
  | `<字符串>`      | 匹配**包含指定字符串**的文本                                 | \<fa\>  | <u>fa</u>n， a<u>fa</u>，aaa<u>fa</u>bbb   |
  | `[字符串集合]`  | 匹配字符串集合中**任意一个字符**。<br/>可以使用一 个`-`表明命名字符的范围：<br/>`[a-z]`匹配任何字母,`[0-9]`匹配任何数字 | [xz]    | di<u>z</u><u>z</u>y，<u>x</u>-ray          |
  | `[^字符串集合]` | 匹配**不包含字符串集合中任意字符**的文本                     | [^abc]  | desk， k8s                                 |
  | `字符串{n,}`    | 匹配**至少n次**它**前面的字符串**                            | b{2}    | bb，bbb，bbbb，bbbbbbb                     |
  | `字符串{n,m}`   | 匹配**[n, m]次**它**前面的字符串**。<br>如果n为0，n可省      | b{2, 4} | bb，bbb，bbbb                              |

# 7.3 逻辑运算符

- `NOT`或`!`：逻辑非

  - 当给定的值为0时返回1；
  - 当给定的值为非0值时返回0； 
  - 当给定的值为NULL时，返回NULL

- `AND`或`&&`：逻辑与。

  - 当给定的所有值均为非0值，并且都不为NULL时，返回 1；
  - 当给定的一个值或者多个值为0时则返回0；
  - 否则返回NULL

- `OR`或`||`：逻辑或。

  - 当给定的值都不为NULL，并且任何一个值为非0值时，则返回1，否则返回0；
  - 当一个值为NULL，并且另一个值为非0值时，返回1，否则返回NULL；
  - 当两个值都为 NULL时，返回NULL

  <p><front style="background: yellow">`AND`的优先级高于`OR`</front></p>

- `XOR`：逻辑异或。

  - 当给定的值中任意一个是null时，返回null
  - 当两个非null的值都是0或者都不是0时，返回0
  - 当一个值为0，另一个不为0时，返回1

# 7.4 位运算符

- `&`：按位与。将给定值对应的二进制数进行逻辑与运算（逻辑与：两个二进制位都是1时返回1，其他返回0）。
- `|`：按位或。将给定值对应的二进制数进行逻辑或运算（逻辑或：两个二进制位全为0时返回0，其他返回1）。
- `^`：按位异或。将给定值对应的二进制数进行逻辑异或运算（逻辑异或：两个二进制位数值相同时返回1，否则返回0）。
- `~`：按位取反。将给定值对应的二进制数进行取反操作（取反：0变1，1变0）。
- `>>`：按位右移，语法`数值 >> 位数`。
- `<<`：按位左移，语法`数值 << 位数`。
