# 3 关系型数据库设计原则

> 前言

- 关系型数据库的典型数据结构就是 **数据表** ，这些数据表的组成都是**结构化的（Structured）**。 
- 将数据放到表中，表再放到库中。 
- 一个数据库中可以有多个表，每个表都有一个名字，用来标识自己。
- 表名具有唯一性。 表具有一些特性，这些特性定义了数据在表中如何存储，类似Java和Python中 “类”的设计。

## 3.1 表、记录、字段

- **E-R**（entity-relationship，实体-联系）模型中有三个主要概念是： `实体集` 、 `属性` 、 `联系集 `。 
- 一个实体集（class）对应于数据库中的一个**表（table**），一个实体（instance）则对应于数据库表 中的一**行（row）**，也称为一条**记录（record）**。一个属性（attribute）对应于数据库表中的一**列 （column）**，也称为一个**字段（field）**。
- ORM思想 (Object Relational Mapping)体现： 
  - 数据库中的一个表 <---> Java或Python中的一个类 
  - 表中的一条数据 <---> 类中的一个对象（或实例） 
  - 表中的一个列 <----> 类中的一个字段、属性(field)

## 3.2 表的关联关系

> 概述

- 表与表之间的数据记录有关系(relationship)。现实世界中的各种实体以及实体之间的各种联系均用 关系模型来表示。 
- 分类：一对一关联、一对多关联、多对多关联、自我引用

> 一对一关联（one-to-one） 

- 在实际的开发中应用不多，因为一对一可以创建成一张表。 
- 举例：设计 `学生表` ：学号、姓名、手机号码、班级、系别、身份证号码、家庭住址、籍贯、紧急 联系人、... 
  - 拆为两个表：两个表的记录是一一对应关系。 
  - 基础信息表 （常用信息）：学号、姓名、手机号码、班级、系别 
  - 档案信息表 （不常用信息）：学号、身份证号码、家庭住址、籍贯、紧急联系人、...
- <front style="background: yellow">两种建表原则</front>： 
  - 外键唯一：主表的主键和从表的外键（唯一），形成主外键关系，外键唯一。 
  - 外键是主键：主表的主键和从表的主键，形成主外键关系。

> 一对多关系（one-to-many）

- 常见实例场景： 客户表和订单表 ， 分类表和商品表 ， 部门表和员工表 。 
- 举例： 员工表：编号、姓名、...、所属部门 部门表：编号、名称、简介 
- <front style="background: yellow">一对多建表原则</front>：在从表(多方)创建一个字段，字段作为外键指向主表(一方)的主键

> 多对多（many-to-many）

- 定义：要表示多对多关系，必须创建第三个表，该表通常称为 **联接表** ，它将多对多关系划分为两个一对多关 系。将这两个表的主键都插入到第三个表中。
- 举例：
  - 学生和课程（一个学生可以选多门课程，一个课程可以被多名学生选择）：学生表、课程表、学生选课信息表
  - 产品和订单（一个产品可以出现在多个订单中，一个订单可以有多个产品）：产品表、订单表、订单明细表

> 自我引用(Self reference)

- 举例：员工表中属性：员工编号，员工姓名，员工主管编号，...。其中员工主管编号就是员工主管的员工编号。表中字段指向了另一个字段。