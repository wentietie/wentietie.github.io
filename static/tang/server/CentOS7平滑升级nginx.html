<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <style>
      :root {
        --c-bg: #fff;
      }

      html.dark {
        --c-bg: #22272e;
      }

      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <title>CentOS7平滑升级nginx | wenatie</title><meta name="description" content="我的个人博客">
    <link rel="preload" href="/assets/style-qprCm-5e.css" as="style"><link rel="stylesheet" href="/assets/style-qprCm-5e.css">
    <link rel="modulepreload" href="/assets/app-CQavEA7Q.js"><link rel="modulepreload" href="/assets/CentOS7平滑升级nginx.html-SQDSaxeH.js">
    <link rel="prefetch" href="/assets/index.html-D9TU5PK4.js" as="script"><link rel="prefetch" href="/assets/jsonutil.html-LZl0naJ4.js" as="script"><link rel="prefetch" href="/assets/jsonView.html-DeAYDW8C.js" as="script"><link rel="prefetch" href="/assets/part1.html-DuR5GfT_.js" as="script"><link rel="prefetch" href="/assets/part2.html-Btel-p8U.js" as="script"><link rel="prefetch" href="/assets/part3.html-uchQkMsf.js" as="script"><link rel="prefetch" href="/assets/part4.html-BoiaTHuW.js" as="script"><link rel="prefetch" href="/assets/part1.html-CYaBoSUq.js" as="script"><link rel="prefetch" href="/assets/part2.html-DfGCwRaP.js" as="script"><link rel="prefetch" href="/assets/part1.html-DAhCmPbl.js" as="script"><link rel="prefetch" href="/assets/part2.html-Cajr2H2D.js" as="script"><link rel="prefetch" href="/assets/part1.html-C-_HPzqk.js" as="script"><link rel="prefetch" href="/assets/part2.html-pyZEfNnc.js" as="script"><link rel="prefetch" href="/assets/spring6.html-DxTeVIju.js" as="script"><link rel="prefetch" href="/assets/fzzj.html-D3YMxYan.js" as="script"><link rel="prefetch" href="/assets/smzqhs.html-CIeemtFe.js" as="script"><link rel="prefetch" href="/assets/vue-slsx.html-D7-7dotJ.js" as="script"><link rel="prefetch" href="/assets/vueyuanli.html-CtBuPc7I.js" as="script"><link rel="prefetch" href="/assets/ysbd.html-DAfYkNhA.js" as="script"><link rel="prefetch" href="/assets/git.html-BtBTYVND.js" as="script"><link rel="prefetch" href="/assets/wp-1.html-DGqwZ3Ug.js" as="script"><link rel="prefetch" href="/assets/part1.html-VECCkrWb.js" as="script"><link rel="prefetch" href="/assets/part1.html-tZ2ol_VE.js" as="script"><link rel="prefetch" href="/assets/part2.html-BnexerQB.js" as="script"><link rel="prefetch" href="/assets/part3.html-DMVGXVsn.js" as="script"><link rel="prefetch" href="/assets/part4.html-Dupvo3oF.js" as="script"><link rel="prefetch" href="/assets/index.html-Q7v54NOG.js" as="script"><link rel="prefetch" href="/assets/es6-1.html-BSRfMlmj.js" as="script"><link rel="prefetch" href="/assets/es6-10.html-CDnRrRY5.js" as="script"><link rel="prefetch" href="/assets/es6-11.html-CgprtUKz.js" as="script"><link rel="prefetch" href="/assets/es6-12.html-BSCUL77S.js" as="script"><link rel="prefetch" href="/assets/es6-13.html-0-xDO0qt.js" as="script"><link rel="prefetch" href="/assets/es6-14.html-CJ2Z1PHP.js" as="script"><link rel="prefetch" href="/assets/es6-15.html-DT_RvXDV.js" as="script"><link rel="prefetch" href="/assets/es6-16.html-POsTw3oa.js" as="script"><link rel="prefetch" href="/assets/es6-17.html-B-e9nh5_.js" as="script"><link rel="prefetch" href="/assets/es6-18.html-DXwSI5n3.js" as="script"><link rel="prefetch" href="/assets/es6-2.html-DuKDvLxP.js" as="script"><link rel="prefetch" href="/assets/es6-3.html-DH17eYgY.js" as="script"><link rel="prefetch" href="/assets/es6-4.html-B24VfRfC.js" as="script"><link rel="prefetch" href="/assets/es6-5.html-CJQa4RTW.js" as="script"><link rel="prefetch" href="/assets/es6-6.html-C6IsZQ-R.js" as="script"><link rel="prefetch" href="/assets/es6-7.html-D5L_rKY-.js" as="script"><link rel="prefetch" href="/assets/es6-8.html-2hp2Z5S8.js" as="script"><link rel="prefetch" href="/assets/es6-9.html-D0wp4hl6.js" as="script"><link rel="prefetch" href="/assets/p1.html-DAGMjZrC.js" as="script"><link rel="prefetch" href="/assets/ts-basic.html-DtCamA7t.js" as="script"><link rel="prefetch" href="/assets/part1.html-BEuhbRUY.js" as="script"><link rel="prefetch" href="/assets/part2.html-DgENipGT.js" as="script"><link rel="prefetch" href="/assets/kuayu.html-DS9Z_fck.js" as="script"><link rel="prefetch" href="/assets/layout.html-DOjL4-VP.js" as="script"><link rel="prefetch" href="/assets/refresh.html-DHNgRh43.js" as="script"><link rel="prefetch" href="/assets/route.html-BTucMrWE.js" as="script"><link rel="prefetch" href="/assets/storage.html-DseLBXIB.js" as="script"><link rel="prefetch" href="/assets/xmlhttprequest.html-C3rqbaqh.js" as="script"><link rel="prefetch" href="/assets/autoheight.html-B22bW-QG.js" as="script"><link rel="prefetch" href="/assets/css-selector.html-DiD0Jn5Z.js" as="script"><link rel="prefetch" href="/assets/CSSchangyong.html-HKIk6sFf.js" as="script"><link rel="prefetch" href="/assets/flex.html-DVtIkvzR.js" as="script"><link rel="prefetch" href="/assets/grid.html-DbO8w-Sc.js" as="script"><link rel="prefetch" href="/assets/longlist.html-DUlXnfnH.js" as="script"><link rel="prefetch" href="/assets/beforeunload.html-C3lhmZqp.js" as="script"><link rel="prefetch" href="/assets/buding.html-CJa1xvpx.js" as="script"><link rel="prefetch" href="/assets/hwdj.html-CLU3HKgV.js" as="script"><link rel="prefetch" href="/assets/modules.html-B2gBAUZN.js" as="script"><link rel="prefetch" href="/assets/pro-compile.html-BPXz-Kir.js" as="script"><link rel="prefetch" href="/assets/usually-functions.html-DdC_yayp.js" as="script"><link rel="prefetch" href="/assets/vue-webpack-optimize.html-B91GmpMm.js" as="script"><link rel="prefetch" href="/assets/webpack-optimize.html-D7MDUft5.js" as="script"><link rel="prefetch" href="/assets/linuxinstallnode.html-DTOJk79P.js" as="script"><link rel="prefetch" href="/assets/node.html-BUzF0zqb.js" as="script"><link rel="prefetch" href="/assets/Docker.html-3_iuw04G.js" as="script"><link rel="prefetch" href="/assets/docker搭建私有镜像仓库.html-C_sXDX-0.js" as="script"><link rel="prefetch" href="/assets/01_Elasticsearch概述.html-D3dTThyb.js" as="script"><link rel="prefetch" href="/assets/02_Elasticsearch相关工具的安装与使用.html-CNs0oPvW.js" as="script"><link rel="prefetch" href="/assets/03_Elasticsearch核心概念.html-B8Jsmbny.js" as="script"><link rel="prefetch" href="/assets/04_Elasticsearch基本操作.html-BFZHgqlz.js" as="script"><link rel="prefetch" href="/assets/05_Elasticsearch DSL高级查询.html-9cXxQ6jr.js" as="script"><link rel="prefetch" href="/assets/06_Elasticsearch进阶查询.html-Dqwzde1E.js" as="script"><link rel="prefetch" href="/assets/07_Java API 操作 Elasticsearch.html-ps0yFC1m.js" as="script"><link rel="prefetch" href="/assets/08_Spring Data Elasticsearch.html-Dq6HFOqZ.js" as="script"><link rel="prefetch" href="/assets/09_Linux 安装 Elasticsearch.html-nOLXHv5R.js" as="script"><link rel="prefetch" href="/assets/10_CAP定理.html-DiYr_Lng.js" as="script"><link rel="prefetch" href="/assets/11_Elasticsearch集群.html-DbTW8Wvf.js" as="script"><link rel="prefetch" href="/assets/12_Elasticsearch分片控制与原理.html-C0Gmpg72.js" as="script"><link rel="prefetch" href="/assets/13_Elasticsearch的优化建议.html-fBGdxXKT.js" as="script"><link rel="prefetch" href="/assets/gitlab-commands.html-Cl4PKdwc.js" as="script"><link rel="prefetch" href="/assets/gitlab-error.html-S_wwpjpH.js" as="script"><link rel="prefetch" href="/assets/jetlinks项目初体验.html-DusYv5BZ.js" as="script"><link rel="prefetch" href="/assets/00_前言.html-BnRR9tk6.js" as="script"><link rel="prefetch" href="/assets/01_Java语言概述.html-CqwmXzmp.js" as="script"><link rel="prefetch" href="/assets/02_Java基本语法.html-CykegFcq.js" as="script"><link rel="prefetch" href="/assets/03_Java数组.html-D1IqVnVE.js" as="script"><link rel="prefetch" href="/assets/04_面向对象编程（上）.html-Dnuu1b3H.js" as="script"><link rel="prefetch" href="/assets/05_面向对象编程（中）.html-OnmoBP3L.js" as="script"><link rel="prefetch" href="/assets/06_面向对象编程（下）.html-CQvF0gJ0.js" as="script"><link rel="prefetch" href="/assets/07_异常处理.html-DHb2BV4-.js" as="script"><link rel="prefetch" href="/assets/08_多线程.html-BALv19kB.js" as="script"><link rel="prefetch" href="/assets/09_Java常用类.html-RcVv5TNx.js" as="script"><link rel="prefetch" href="/assets/10_枚举_注解.html-DPbASkNb.js" as="script"><link rel="prefetch" href="/assets/11_Java集合.html-C3CWkJ2Y.js" as="script"><link rel="prefetch" href="/assets/12_Java泛型.html-iPR3FiQM.js" as="script"><link rel="prefetch" href="/assets/13_IO流.html-Dq2JAHmY.js" as="script"><link rel="prefetch" href="/assets/14_网络编程.html-CYrngJuT.js" as="script"><link rel="prefetch" href="/assets/15_Java反射机制.html-C1eQWNgZ.js" as="script"><link rel="prefetch" href="/assets/16_Java8新特性.html-2DGhK0AY.js" as="script"><link rel="prefetch" href="/assets/17_Java9_10_11新特性.html-CfbYEHyB.js" as="script"><link rel="prefetch" href="/assets/18_JUC并发编程.html-oatHzLy0.js" as="script"><link rel="prefetch" href="/assets/19_设计模式.html-DXLXwTcW.js" as="script"><link rel="prefetch" href="/assets/20_排序算法.html-DLEULPah.js" as="script"><link rel="prefetch" href="/assets/99_面试题.html-CPHzGkSM.js" as="script"><link rel="prefetch" href="/assets/1.html-f1DBn7MR.js" as="script"><link rel="prefetch" href="/assets/2.html-va9UcIRc.js" as="script"><link rel="prefetch" href="/assets/01_MySQL概述.html-C8Q_Psq1.js" as="script"><link rel="prefetch" href="/assets/02_关系型数据库与非关系型数据库.html-gjmNMpOb.js" as="script"><link rel="prefetch" href="/assets/03_关系型数据库设计原则.html-DDXsl_C7.js" as="script"><link rel="prefetch" href="/assets/04_MySQL的登录.html-BY3t7uMo.js" as="script"><link rel="prefetch" href="/assets/05_MySQL一些常用命令.html-Cgc8upLJ.js" as="script"><link rel="prefetch" href="/assets/06_MySQL图形化管理工具.html-aLdZj_pt.js" as="script"><link rel="prefetch" href="/assets/07_运算符.html-COZBKyFO.js" as="script"><link rel="prefetch" href="/assets/08_MySQL函数.html-BcZzqzDX.js" as="script"><link rel="prefetch" href="/assets/09_子查询.html-CWGoKIWz.js" as="script"><link rel="prefetch" href="/assets/10_管理数据库和数据库表.html-pqm0St5R.js" as="script"><link rel="prefetch" href="/assets/11_数据的增删改.html-GrywX9YI.js" as="script"><link rel="prefetch" href="/assets/12_MySQL中的数据类型.html-BzKtiP7s.js" as="script"><link rel="prefetch" href="/assets/13_约束.html-BaBKFRnT.js" as="script"><link rel="prefetch" href="/assets/14_视图.html-DsYzF2sO.js" as="script"><link rel="prefetch" href="/assets/15_存储过程与存储函数.html-jrfS-HMC.js" as="script"><link rel="prefetch" href="/assets/16_变量、流程控制与游标.html-TVRDO7BE.js" as="script"><link rel="prefetch" href="/assets/17_触发器.html-CLwsoZvN.js" as="script"><link rel="prefetch" href="/assets/18_MySQL8.0新特性.html-D9tKUcdl.js" as="script"><link rel="prefetch" href="/assets/19_表及其数据.html-CcfzqEyu.js" as="script"><link rel="prefetch" href="/assets/99_MySQL常见问题的解决.html-Cmfiks6g.js" as="script"><link rel="prefetch" href="/assets/1.html-DRdURDYh.js" as="script"><link rel="prefetch" href="/assets/2.html-CUsmJZJq.js" as="script"><link rel="prefetch" href="/assets/3.html-C58tzy3R.js" as="script"><link rel="prefetch" href="/assets/1.html-D8pRQcSZ.js" as="script"><link rel="prefetch" href="/assets/2.html-BqvXgRFl.js" as="script"><link rel="prefetch" href="/assets/CentOS7root账号免密登录.html-DctTv2eG.js" as="script"><link rel="prefetch" href="/assets/CentOS7安装GitLab.html-B1bXSpSz.js" as="script"><link rel="prefetch" href="/assets/CentOS7安装jdk1.8.html-Cp2sUu7S.js" as="script"><link rel="prefetch" href="/assets/CentOs7安装jenkins.html-kkIGKWlN.js" as="script"><link rel="prefetch" href="/assets/CentOS7安装mysql5.7(使用yum源安装).html-CtlyH-FO.js" as="script"><link rel="prefetch" href="/assets/CentOS7安装redis.html-Bs_ewyNC.js" as="script"><link rel="prefetch" href="/assets/借助阿里云服务器使用frp做内网穿透.html-QjIQiEJ0.js" as="script"><link rel="prefetch" href="/assets/1.html-CNnznj-q.js" as="script"><link rel="prefetch" href="/assets/1.html-CKoYdiOz.js" as="script"><link rel="prefetch" href="/assets/2.html-BDVJ1zy3.js" as="script"><link rel="prefetch" href="/assets/3.html-BQcpS3RU.js" as="script"><link rel="prefetch" href="/assets/记一次小程序接口的发布.html-C76Q13-u.js" as="script"><link rel="prefetch" href="/assets/part1.html-BFnwRZFJ.js" as="script"><link rel="prefetch" href="/assets/part1.html-C9faX_IY.js" as="script"><link rel="prefetch" href="/assets/part1.html-DNBoUve7.js" as="script"><link rel="prefetch" href="/assets/part10.html-BJwbvDDq.js" as="script"><link rel="prefetch" href="/assets/part11.html-Bn3DeWYA.js" as="script"><link rel="prefetch" href="/assets/part12.html-B1QUg5xj.js" as="script"><link rel="prefetch" href="/assets/part2.html-CkDiGo_Y.js" as="script"><link rel="prefetch" href="/assets/part3.html-BclsmWNQ.js" as="script"><link rel="prefetch" href="/assets/part9.html-DeTjE1Qr.js" as="script"><link rel="prefetch" href="/assets/auto.html-BERgrtnz.js" as="script"><link rel="prefetch" href="/assets/blog.html-DYbMea1Z.js" as="script"><link rel="prefetch" href="/assets/command.html-uSaDY-MC.js" as="script"><link rel="prefetch" href="/assets/ftp.html-CmsKcTKV.js" as="script"><link rel="prefetch" href="/assets/1.html-IYM5_Tc0.js" as="script"><link rel="prefetch" href="/assets/2.html-3JVQcnA6.js" as="script"><link rel="prefetch" href="/assets/3.html-BqRVsE7k.js" as="script"><link rel="prefetch" href="/assets/4.html-RJRUgzQC.js" as="script"><link rel="prefetch" href="/assets/6443_connect-refused.html-Bl6Hbf_D.js" as="script"><link rel="prefetch" href="/assets/404.html-Dd7dlws0.js" as="script"><link rel="prefetch" href="/assets/JsonUtil-BkU8Y0qk.js" as="script"><link rel="prefetch" href="/assets/JsonView-CW8a3djt.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon"><!--[--><header class="vp-navbar"><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><span class="vp-site-name" aria-hidden="true">wenatie</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="首页"><!---->首页<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端工具"><span class="title">前端工具</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端工具"><span class="title">前端工具</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/utils/jsonutil.html" aria-label="JSON工具"><!---->JSON工具<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/utils/jsonView.html" aria-label="JSON View"><!---->JSON View<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="AI"><span class="title">AI</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="AI"><span class="title">AI</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/ai/llm/llm-study/part1.html" aria-label="大模型入门"><!---->大模型入门<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/ai/llm/chatglm/part1.html" aria-label="chatGLM大模型实践"><!---->chatGLM大模型实践<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="小唐学习笔记"><span class="title">小唐学习笔记</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="小唐学习笔记"><span class="title">小唐学习笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/gitlab/gitlab-error.html" aria-label="gitlab"><!---->gitlab<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/java2/00_%E5%89%8D%E8%A8%80.html" aria-label="java"><!---->java<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/mysql/01_MySQL%E6%A6%82%E8%BF%B0.html" aria-label="mysql"><!---->mysql<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/docker/Docker.html" aria-label="docker"><!---->docker<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/k8s/%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/command.html" aria-label="k8s"><!---->k8s<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/Elasticsearch/01_Elasticsearch%E6%A6%82%E8%BF%B0.html" aria-label="Elasticsearch"><!---->Elasticsearch<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/Prometheus/1.html" aria-label="Prometheus"><!---->Prometheus<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/Python/1.html" aria-label="Python"><!---->Python<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/Vue/1.html" aria-label="Vue"><!---->Vue<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/server/CentOS7root%E8%B4%A6%E5%8F%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95.html" aria-label="服务器环境安装"><!---->服务器环境安装<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/mservice/2.html" aria-label="微服务"><!---->微服务<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/%E9%A1%B9%E7%9B%AE%E4%B8%8A%E7%BA%BF/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%8F%91%E5%B8%83.html" aria-label="项目上线"><!---->项目上线<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/IoTPlatform/jetlinks%E9%A1%B9%E7%9B%AE%E5%88%9D%E4%BD%93%E9%AA%8C.html" aria-label="物联网项目"><!---->物联网项目<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/JavaScript/basic/part1.html" aria-label="JS基础"><!---->JS基础<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/JavaScript/es6/es6-1.html" aria-label="ES6入门"><!---->ES6入门<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/JavaScript/youdontknowjs/part1.html" aria-label="你不知道的Javascript"><!---->你不知道的Javascript<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/JavaScript/design/" aria-label="设计模式"><!---->设计模式<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/JavaScript/typescript/ts-basic.html" aria-label="typescript"><!---->typescript<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="框架"><span class="title">框架</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="框架"><span class="title">框架</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/formwork/vue/vueyuanli.html" aria-label="vue2"><!---->vue2<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/formwork/vue3/reactive/part1.html" aria-label="vue3"><!---->vue3<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/formwork/spring5/part1.html" aria-label="spring5"><!---->spring5<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="计算机基础"><span class="title">计算机基础</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="计算机基础"><span class="title">计算机基础</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/end/c/data-contruction/part1.html" aria-label="数据结构（严蔚敏）"><!---->数据结构（严蔚敏）<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="随笔笔记"><span class="title">随笔笔记</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="随笔笔记"><span class="title">随笔笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/notes/JS/hwdj.html" aria-label="JS相关"><!---->JS相关<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/notes/CSS/css-selector.html" aria-label="CSS相关"><!---->CSS相关<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/notes/browser/xmlhttprequest.html" aria-label="浏览器相关"><!---->浏览器相关<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/notes/node/node.html" aria-label="node相关"><!---->node相关<!----></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar"><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="首页"><!---->首页<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端工具"><span class="title">前端工具</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端工具"><span class="title">前端工具</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/utils/jsonutil.html" aria-label="JSON工具"><!---->JSON工具<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/utils/jsonView.html" aria-label="JSON View"><!---->JSON View<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="AI"><span class="title">AI</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="AI"><span class="title">AI</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/ai/llm/llm-study/part1.html" aria-label="大模型入门"><!---->大模型入门<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/ai/llm/chatglm/part1.html" aria-label="chatGLM大模型实践"><!---->chatGLM大模型实践<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="小唐学习笔记"><span class="title">小唐学习笔记</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="小唐学习笔记"><span class="title">小唐学习笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/gitlab/gitlab-error.html" aria-label="gitlab"><!---->gitlab<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/java2/00_%E5%89%8D%E8%A8%80.html" aria-label="java"><!---->java<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/mysql/01_MySQL%E6%A6%82%E8%BF%B0.html" aria-label="mysql"><!---->mysql<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/docker/Docker.html" aria-label="docker"><!---->docker<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/k8s/%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/command.html" aria-label="k8s"><!---->k8s<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/Elasticsearch/01_Elasticsearch%E6%A6%82%E8%BF%B0.html" aria-label="Elasticsearch"><!---->Elasticsearch<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/Prometheus/1.html" aria-label="Prometheus"><!---->Prometheus<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/Python/1.html" aria-label="Python"><!---->Python<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/Vue/1.html" aria-label="Vue"><!---->Vue<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/server/CentOS7root%E8%B4%A6%E5%8F%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95.html" aria-label="服务器环境安装"><!---->服务器环境安装<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/mservice/2.html" aria-label="微服务"><!---->微服务<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/%E9%A1%B9%E7%9B%AE%E4%B8%8A%E7%BA%BF/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%8F%91%E5%B8%83.html" aria-label="项目上线"><!---->项目上线<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/tang/IoTPlatform/jetlinks%E9%A1%B9%E7%9B%AE%E5%88%9D%E4%BD%93%E9%AA%8C.html" aria-label="物联网项目"><!---->物联网项目<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/JavaScript/basic/part1.html" aria-label="JS基础"><!---->JS基础<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/JavaScript/es6/es6-1.html" aria-label="ES6入门"><!---->ES6入门<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/JavaScript/youdontknowjs/part1.html" aria-label="你不知道的Javascript"><!---->你不知道的Javascript<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/JavaScript/design/" aria-label="设计模式"><!---->设计模式<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/JavaScript/typescript/ts-basic.html" aria-label="typescript"><!---->typescript<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="框架"><span class="title">框架</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="框架"><span class="title">框架</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/formwork/vue/vueyuanli.html" aria-label="vue2"><!---->vue2<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/formwork/vue3/reactive/part1.html" aria-label="vue3"><!---->vue3<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/formwork/spring5/part1.html" aria-label="spring5"><!---->spring5<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="计算机基础"><span class="title">计算机基础</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="计算机基础"><span class="title">计算机基础</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/end/c/data-contruction/part1.html" aria-label="数据结构（严蔚敏）"><!---->数据结构（严蔚敏）<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="随笔笔记"><span class="title">随笔笔记</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="随笔笔记"><span class="title">随笔笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/notes/JS/hwdj.html" aria-label="JS相关"><!---->JS相关<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/notes/CSS/css-selector.html" aria-label="CSS相关"><!---->CSS相关<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/notes/browser/xmlhttprequest.html" aria-label="浏览器相关"><!---->浏览器相关<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/static/notes/node/node.html" aria-label="node相关"><!---->node相关<!----></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">服务器环境安装 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/static/tang/server/CentOS7root%E8%B4%A6%E5%8F%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95.html" aria-label="CentOS7root账号免密登录"><!---->CentOS7root账号免密登录<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/static/tang/server/CentOS7%E5%AE%89%E8%A3%85GitLab.html" aria-label="CentOS7安装GitLab"><!---->CentOS7安装GitLab<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/static/tang/server/CentOS7%E5%AE%89%E8%A3%85jdk1.8.html" aria-label="CentOS7安装jdk1.8"><!---->CentOS7安装jdk1.8<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/static/tang/server/CentOs7%E5%AE%89%E8%A3%85jenkins.html" aria-label="CentOs7安装jenkins"><!---->CentOs7安装jenkins<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/static/tang/server/CentOS7%E5%AE%89%E8%A3%85mysql5.7(%E4%BD%BF%E7%94%A8yum%E6%BA%90%E5%AE%89%E8%A3%85).html" aria-label="使用yum源安装MySQL5.7 CentOS7安装mysql5.7"><!---->使用yum源安装MySQL5.7 CentOS7安装mysql5.7<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/static/tang/server/CentOS7%E5%AE%89%E8%A3%85redis.html" aria-label="CentOS7安装redis"><!---->CentOS7安装redis<!----></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/static/tang/server/CentOS7%E5%B9%B3%E6%BB%91%E5%8D%87%E7%BA%A7nginx.html" aria-label="CentOS7平滑升级nginx"><!---->CentOS7平滑升级nginx<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/static/tang/server/%E5%80%9F%E5%8A%A9%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BD%BF%E7%94%A8frp%E5%81%9A%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F.html" aria-label="借助阿里云服务器使用frp做内网穿透"><!---->借助阿里云服务器使用frp做内网穿透<!----></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="centos7平滑升级nginx" tabindex="-1"><a class="header-anchor" href="#centos7平滑升级nginx"><span>CentOS7平滑升级nginx</span></a></h1><blockquote><p>准备：</p></blockquote><p>下载并上传<code>nginx-1.14.2.tar.gz</code>、<code>nginx-1.22.0.tar.gz</code>到<code>/usr/tth/</code>路径。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ tth<span class="token punctuation">]</span><span class="token comment"># pwd</span></span>
<span class="line">/usr/tth</span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ tth<span class="token punctuation">]</span><span class="token comment"># ll</span></span>
<span class="line">total <span class="token number">2044</span></span>
<span class="line">-rw-r--r-- <span class="token number">1</span> root root <span class="token number">1015384</span> Oct <span class="token number">18</span> <span class="token number">11</span>:13 nginx-1.14.2.tar.gz</span>
<span class="line">-rw-r--r-- <span class="token number">1</span> root root <span class="token number">1073322</span> Oct <span class="token number">18</span> <span class="token number">11</span>:13 nginx-1.22.0.tar.gz</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>说明</p></blockquote><p>本教程是将nginx从1.14.2版本平滑升级到1.22.0版本。首先介绍1.14.2版本的nginx的安装，然后再进行平滑升级。 如果已有低版本的nginx，可以跳过<span style="background-color:orange;padding:0 5px;border-radius:5px;margin:0 5px;">1 安装旧版本nginx</span>部分。</p><h2 id="_1-安装旧版本nginx" tabindex="-1"><a class="header-anchor" href="#_1-安装旧版本nginx"><span>1 安装旧版本nginx</span></a></h2><h3 id="_1-1-解压-nginx-1-14-2-tar-gz" tabindex="-1"><a class="header-anchor" href="#_1-1-解压-nginx-1-14-2-tar-gz"><span>1.1 解压 nginx-1.14.2.tar.gz</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 进入/usr/tth/目录</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ tth<span class="token punctuation">]</span><span class="token comment"># cd /usr/tth/</span></span>
<span class="line"><span class="token comment"># 解压</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ tth<span class="token punctuation">]</span><span class="token comment"># tar zxf nginx-1.14.2.tar.gz</span></span>
<span class="line"><span class="token comment"># 查看解压结果</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ tth<span class="token punctuation">]</span><span class="token comment"># ll</span></span>
<span class="line">total <span class="token number">2044</span></span>
<span class="line">drwxr-xr-x <span class="token number">8</span> <span class="token number">1001</span> <span class="token number">1001</span>     <span class="token number">158</span> Dec  <span class="token number">4</span>  <span class="token number">2018</span> nginx-1.14.2 <span class="token comment"># 新增nginx-1.14.2文件夹</span></span>
<span class="line">-rw-r--r-- <span class="token number">1</span> root root <span class="token number">1015384</span> Oct <span class="token number">18</span> <span class="token number">11</span>:13 nginx-1.14.2.tar.gz</span>
<span class="line">-rw-r--r-- <span class="token number">1</span> root root <span class="token number">1073322</span> Oct <span class="token number">18</span> <span class="token number">11</span>:13 nginx-1.22.0.tar.gz</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-准备nginx安装路径" tabindex="-1"><a class="header-anchor" href="#_1-2-准备nginx安装路径"><span>1.2 准备nginx安装路径</span></a></h3><p>创建<code>/usr/local/nginx/1.14.2/</code>文件夹，作为nginx-1.14.2的安装目录</p><h3 id="_1-3-编译安装" tabindex="-1"><a class="header-anchor" href="#_1-3-编译安装"><span>1.3 编译安装</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 进入/usr/tth/nginx-1.14.2/目录</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ tth<span class="token punctuation">]</span><span class="token comment"># cd /usr/tth/nginx-1.14.2/</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 配置nginx</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.14.2<span class="token punctuation">]</span><span class="token comment"># ./configure --prefix=/usr/local/nginx/1.14.2</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 编译并安装</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.14.2<span class="token punctuation">]</span><span class="token comment"># make &amp;&amp; make install</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看安装结果</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.14.2<span class="token punctuation">]</span><span class="token comment"># ll /usr/local/nginx/1.14.2/</span></span>
<span class="line">total <span class="token number">0</span></span>
<span class="line">drwxr-xr-x <span class="token number">2</span> root root <span class="token number">333</span> Oct <span class="token number">18</span> <span class="token number">15</span>:43 conf</span>
<span class="line">drwxr-xr-x <span class="token number">2</span> root root  <span class="token number">40</span> Oct <span class="token number">18</span> <span class="token number">15</span>:43 html</span>
<span class="line">drwxr-xr-x <span class="token number">2</span> root root   <span class="token number">6</span> Oct <span class="token number">18</span> <span class="token number">15</span>:43 logs</span>
<span class="line">drwxr-xr-x <span class="token number">2</span> root root  <span class="token number">19</span> Oct <span class="token number">18</span> <span class="token number">15</span>:43 sbin</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-4-修改nginx端口" tabindex="-1"><a class="header-anchor" href="#_1-4-修改nginx端口"><span>1.4 修改nginx端口</span></a></h3><p>将nginx端口，由80改为81（此步骤可省，用80也行。此处是为了确保在升级时，旧版本的配置仍旧生效）</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">vim</span> /usr/local/nginx/1.14.2/conf/nginx.conf</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="/assets/nginx-update-1-CPcQZaav.png" alt=""></p><h3 id="_1-5-运行" tabindex="-1"><a class="header-anchor" href="#_1-5-运行"><span>1.5 运行</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 测试配置文件是否正确（输出内容为ok、successful，表示正确。否则需要修改配置文件）</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.14.2<span class="token punctuation">]</span><span class="token comment"># /usr/local/nginx/1.14.2/sbin/nginx -t</span></span>
<span class="line">nginx: the configuration <span class="token function">file</span> /usr/local/nginx/1.14.2/conf/nginx.conf syntax is ok</span>
<span class="line">nginx: configuration <span class="token function">file</span> /usr/local/nginx/1.14.2/conf/nginx.conf <span class="token builtin class-name">test</span> is successful</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 运行</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.14.2<span class="token punctuation">]</span><span class="token comment"># /usr/local/nginx/1.14.2/sbin/nginx</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看进程</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.14.2<span class="token punctuation">]</span><span class="token comment"># ps -ef | grep nginx</span></span>
<span class="line">root     <span class="token number">2837549</span>       <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">15</span>:50 ?        00:00:00 nginx: master process /usr/local/nginx/1.14.2/sbin/nginx</span>
<span class="line">nobody   <span class="token number">2837550</span> <span class="token number">2837549</span>  <span class="token number">0</span> <span class="token number">15</span>:50 ?        00:00:00 nginx: worker process</span>
<span class="line">root     <span class="token number">2837555</span> <span class="token number">2834706</span>  <span class="token number">0</span> <span class="token number">15</span>:52 pts/2    00:00:00 <span class="token function">grep</span> <span class="token parameter variable">--color</span><span class="token operator">=</span>auto nginx</span>
<span class="line"></span>
<span class="line"><span class="token comment">#访问测试（访问成功）</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.14.2<span class="token punctuation">]</span><span class="token comment"># curl http://localhost:81</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>head<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>style<span class="token operator">&gt;</span></span>
<span class="line">    body <span class="token punctuation">{</span></span>
<span class="line">        width: 35em<span class="token punctuation">;</span></span>
<span class="line">        margin: <span class="token number">0</span> auto<span class="token punctuation">;</span></span>
<span class="line">        font-family: Tahoma, Verdana, Arial, sans-serif<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token operator">&lt;</span>/style<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>/head<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>If you see this page, the nginx web server is successfully installed and</span>
<span class="line">working. Further configuration is required.<span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>For online documentation and support please refer to</span>
<span class="line"><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://nginx.org/&quot;</span><span class="token operator">&gt;</span>nginx.org<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>br/<span class="token operator">&gt;</span></span>
<span class="line">Commercial support is available at</span>
<span class="line"><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://nginx.com/&quot;</span><span class="token operator">&gt;</span>nginx.com<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token operator">&lt;</span>em<span class="token operator">&gt;</span>Thank you <span class="token keyword">for</span> using nginx.<span class="token operator">&lt;</span>/em<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>/body<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>/html<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-6-查看nginx版本号" tabindex="-1"><a class="header-anchor" href="#_1-6-查看nginx版本号"><span>1.6 查看nginx版本号</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ tth<span class="token punctuation">]</span><span class="token comment">#  /usr/local/nginx/1.14.2/sbin/nginx -v</span></span>
<span class="line">nginx version: nginx/1.14.2</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-安装新版本nginx" tabindex="-1"><a class="header-anchor" href="#_2-安装新版本nginx"><span>2 安装新版本nginx</span></a></h2><h3 id="_2-1-解压nginx-1-22-0" tabindex="-1"><a class="header-anchor" href="#_2-1-解压nginx-1-22-0"><span>2.1 解压nginx-1.22.0</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 进入/usr/tth/目录</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ tth<span class="token punctuation">]</span><span class="token comment"># cd /usr/tth/</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 解压</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ tth<span class="token punctuation">]</span><span class="token comment"># tar zxf nginx-1.22.0.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看解压结果</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ tth<span class="token punctuation">]</span><span class="token comment"># ll</span></span>
<span class="line">total <span class="token number">2044</span></span>
<span class="line">drwxr-xr-x <span class="token number">9</span> <span class="token number">1001</span> <span class="token number">1001</span>     <span class="token number">186</span> Oct <span class="token number">18</span> <span class="token number">15</span>:35 nginx-1.14.2</span>
<span class="line">-rw-r--r-- <span class="token number">1</span> root root <span class="token number">1015384</span> Oct <span class="token number">18</span> <span class="token number">11</span>:13 nginx-1.14.2.tar.gz</span>
<span class="line">drwxr-xr-x <span class="token number">8</span> <span class="token number">1001</span> <span class="token number">1001</span>     <span class="token number">158</span> May <span class="token number">24</span> 07:59 nginx-1.22.0</span>
<span class="line">-rw-r--r-- <span class="token number">1</span> root root <span class="token number">1073322</span> Oct <span class="token number">18</span> <span class="token number">11</span>:13 nginx-1.22.0.tar.gz</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-查看旧版本配置" tabindex="-1"><a class="header-anchor" href="#_2-2-查看旧版本配置"><span>2.2 查看旧版本配置</span></a></h3><p>新版本在执行<code>./config</code>命令时，需要用到旧版本的配置参数。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ tth<span class="token punctuation">]</span><span class="token comment"># /usr/local/nginx/1.14.2/sbin/nginx -V</span></span>
<span class="line">nginx version: nginx/1.14.2</span>
<span class="line">built by gcc <span class="token number">8.5</span>.0 <span class="token number">20210514</span> <span class="token punctuation">(</span>Red Hat <span class="token number">8.5</span>.0-4<span class="token punctuation">)</span> <span class="token punctuation">(</span>GCC<span class="token punctuation">)</span></span>
<span class="line">configure arguments: <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/usr/local/nginx/1.14.2 <span class="token comment"># 旧版本配置参数</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-编译" tabindex="-1"><a class="header-anchor" href="#_2-3-编译"><span>2.3 编译</span></a></h3><p>注意：此处只编译，不安装。执行完<code>make</code>命令之后，<code>/usr/tth/nginx-1.22.0/</code>会多出一个文件夹</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 进入/usr/tth/nginx-1.22.0目录</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ tth<span class="token punctuation">]</span><span class="token comment"># cd nginx-1.22.0/</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 配置nginx（需要用到上一步中的nginx配置信息）</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># ./configure --prefix=/usr/local/nginx/1.14.2</span></span>
<span class="line"><span class="token comment"># 此时，/usr/tth/nginx-1.22.0路径下会多出objs文件夹</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 编译</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># make</span></span>
<span class="line"><span class="token comment"># 此时/usr/tth/nginx-1.22.0/objs/文件夹下会多出nginx文件，下面会用到</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-升级" tabindex="-1"><a class="header-anchor" href="#_3-升级"><span>3 升级</span></a></h2><h3 id="_3-1-备份旧版本-用新版本替换" tabindex="-1"><a class="header-anchor" href="#_3-1-备份旧版本-用新版本替换"><span>3.1 备份旧版本，用新版本替换</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 备份旧版本</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># mv /usr/local/nginx/1.14.2/sbin/nginx /usr/local/nginx/1.14.2/sbin/nginx_1.14.2</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看备份结果</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># ll /usr/local/nginx/1.14.2/sbin</span></span>
<span class="line">total <span class="token number">4888</span></span>
<span class="line">-rwxr-xr-x <span class="token number">1</span> root root <span class="token number">5001856</span> Oct <span class="token number">18</span> <span class="token number">15</span>:43 nginx_1.14.2</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 复制新版本nginx到/usr/local/nginx/1.14.2/sbin路径下</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># cp /usr/tth/nginx-1.22.0/objs/nginx /usr/local/nginx/1.14.2/sbin/</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看复制结果</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># ll /usr/local/nginx/1.14.2/sbin</span></span>
<span class="line">total <span class="token number">9828</span></span>
<span class="line">-rwxr-xr-x <span class="token number">1</span> root root <span class="token number">5056008</span> Oct <span class="token number">18</span> <span class="token number">16</span>:13 nginx</span>
<span class="line">-rwxr-xr-x <span class="token number">1</span> root root <span class="token number">5001856</span> Oct <span class="token number">18</span> <span class="token number">15</span>:43 nginx_1.14.2</span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment">#</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-测试配置文件是否正确" tabindex="-1"><a class="header-anchor" href="#_3-2-测试配置文件是否正确"><span>3.2 测试配置文件是否正确</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># /usr/local/nginx/1.14.2/sbin/nginx -t</span></span>
<span class="line">nginx: the configuration <span class="token function">file</span> /usr/local/nginx/1.14.2/conf/nginx.conf syntax is ok</span>
<span class="line">nginx: configuration <span class="token function">file</span> /usr/local/nginx/1.14.2/conf/nginx.conf <span class="token builtin class-name">test</span> is successful</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-查看nginx进程" tabindex="-1"><a class="header-anchor" href="#_3-3-查看nginx进程"><span>3.3 查看nginx进程</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># ps -ef | grep nginx</span></span>
<span class="line">root     <span class="token number">2837549</span>       <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">15</span>:50 ?        00:00:00 nginx: master process /usr/local/nginx/1.14.2/sbin/nginx</span>
<span class="line">nobody   <span class="token number">2837550</span> <span class="token number">2837549</span>  <span class="token number">0</span> <span class="token number">15</span>:50 ?        00:00:00 nginx: worker process</span>
<span class="line">root     <span class="token number">2840201</span> <span class="token number">2837586</span>  <span class="token number">0</span> <span class="token number">16</span>:17 pts/4    00:00:00 <span class="token function">grep</span> <span class="token parameter variable">--color</span><span class="token operator">=</span>auto nginx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-4-发送usr2信号" tabindex="-1"><a class="header-anchor" href="#_3-4-发送usr2信号"><span>3.4 发送USR2信号</span></a></h3><p>向主进程（master）发送usr2信号，nginx会启动一个新的版本的master进程和对应工作进程，和旧版本一起处理请求。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># kill -USR2 2837549</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_3-5-查看nginx进程" tabindex="-1"><a class="header-anchor" href="#_3-5-查看nginx进程"><span>3.5 查看nginx进程</span></a></h3><p>如下，多了两个新的进程，说明USR2信号发送成功。</p><p>此时，新旧两个版本的nginx都处于可用状态</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># ps -ef | grep nginx</span></span>
<span class="line">root     <span class="token number">2837549</span>       <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">15</span>:50 ?        00:00:00 nginx: master process /usr/local/nginx/1.14.2/sbin/nginx <span class="token comment"># 旧的nginx</span></span>
<span class="line">nobody   <span class="token number">2837550</span> <span class="token number">2837549</span>  <span class="token number">0</span> <span class="token number">15</span>:50 ?        00:00:00 nginx: worker process</span>
<span class="line">root     <span class="token number">2840202</span> <span class="token number">2837549</span>  <span class="token number">0</span> <span class="token number">16</span>:17 ?        00:00:00 nginx: master process /usr/local/nginx/1.14.2/sbin/nginx <span class="token comment"># 新的nginx</span></span>
<span class="line">nobody   <span class="token number">2840203</span> <span class="token number">2840202</span>  <span class="token number">0</span> <span class="token number">16</span>:17 ?        00:00:00 nginx: worker process</span>
<span class="line">root     <span class="token number">2840205</span> <span class="token number">2837586</span>  <span class="token number">0</span> <span class="token number">16</span>:17 pts/4    00:00:00 <span class="token function">grep</span> <span class="token parameter variable">--color</span><span class="token operator">=</span>auto nginx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-6-发送winch信号" tabindex="-1"><a class="header-anchor" href="#_3-6-发送winch信号"><span>3.6 发送WINCH信号</span></a></h3><p>让旧版本的nginx的进程逐步退出。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 发送WINCH信号</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># kill -WINCH 2837549</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看nginx进程</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># ps aux |grep nginx</span></span>
<span class="line">root     <span class="token number">2837549</span>  <span class="token number">0.0</span>  <span class="token number">0.1</span>  <span class="token number">34328</span>  <span class="token number">2232</span> ?        Ss   <span class="token number">15</span>:50   <span class="token number">0</span>:00 nginx: master process /usr/local/nginx/1.14.2/sbin/nginx</span>
<span class="line">root     <span class="token number">2840202</span>  <span class="token number">0.0</span>  <span class="token number">0.1</span>  <span class="token number">34436</span>  <span class="token number">2940</span> ?        S    <span class="token number">16</span>:17   <span class="token number">0</span>:00 nginx: master process /usr/local/nginx/1.14.2/sbin/nginx</span>
<span class="line">nobody   <span class="token number">2840203</span>  <span class="token number">0.0</span>  <span class="token number">0.2</span>  <span class="token number">66608</span>  <span class="token number">4520</span> ?        S    <span class="token number">16</span>:17   <span class="token number">0</span>:00 nginx: worker process</span>
<span class="line">root     <span class="token number">2840222</span>  <span class="token number">0.0</span>  <span class="token number">0.0</span>  <span class="token number">12132</span>  <span class="token number">1152</span> pts/4    S+   <span class="token number">16</span>:31   <span class="token number">0</span>:00 <span class="token function">grep</span> <span class="token parameter variable">--color</span><span class="token operator">=</span>auto nginx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-7-访问验证" tabindex="-1"><a class="header-anchor" href="#_3-7-访问验证"><span>3.7 访问验证</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># curl http://localhost:81</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>head<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>style<span class="token operator">&gt;</span></span>
<span class="line">  body <span class="token punctuation">{</span></span>
<span class="line">      width: 35em<span class="token punctuation">;</span></span>
<span class="line">      margin: <span class="token number">0</span> auto<span class="token punctuation">;</span></span>
<span class="line">      font-family: Tahoma, Verdana, Arial, sans-serif<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token operator">&lt;</span>/style<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>/head<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>If you see this page, the nginx web server is successfully installed and</span>
<span class="line">working. Further configuration is required.<span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>For online documentation and support please refer to</span>
<span class="line"><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://nginx.org/&quot;</span><span class="token operator">&gt;</span>nginx.org<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>br/<span class="token operator">&gt;</span></span>
<span class="line">Commercial support is available at</span>
<span class="line"><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://nginx.com/&quot;</span><span class="token operator">&gt;</span>nginx.com<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token operator">&lt;</span>em<span class="token operator">&gt;</span>Thank you <span class="token keyword">for</span> using nginx.<span class="token operator">&lt;</span>/em<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>/body<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>/html<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-8-发送hup信号-如果需要回滚的话" tabindex="-1"><a class="header-anchor" href="#_3-8-发送hup信号-如果需要回滚的话"><span>3.8 发送HUP信号（如果需要回滚的话）</span></a></h3><p>注意：此步骤是回滚步骤。如果不需要回滚，直接跳过该步骤</p><p>如果这时需要回退继续使用旧版本，可向旧的Nginx主进程发送HUP信号，它会重新启动工作进程，仍使用旧版配置文件。然后可以将新版Nginx进程杀死（使用QUIT、TERM 、或者KILL）</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">kill</span> <span class="token parameter variable">-HUP</span> <span class="token number">2837549</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_3-9-发送quit信号" tabindex="-1"><a class="header-anchor" href="#_3-9-发送quit信号"><span>3.9 发送QUIT信号</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 发送QUIT信号</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># kill -QUIT 2837549</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看nginx进程（旧版本进程消失）</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># ps aux |grep nginx</span></span>
<span class="line">root     <span class="token number">2840202</span>  <span class="token number">0.0</span>  <span class="token number">0.1</span>  <span class="token number">34436</span>  <span class="token number">2940</span> ?        S    <span class="token number">16</span>:17   <span class="token number">0</span>:00 nginx: master process /usr/local/nginx/1.14.2/sbin/nginx</span>
<span class="line">nobody   <span class="token number">2840203</span>  <span class="token number">0.0</span>  <span class="token number">0.2</span>  <span class="token number">66608</span>  <span class="token number">4520</span> ?        S    <span class="token number">16</span>:17   <span class="token number">0</span>:00 nginx: worker process</span>
<span class="line">root     <span class="token number">2840231</span>  <span class="token number">0.0</span>  <span class="token number">0.0</span>  <span class="token number">12132</span>  <span class="token number">1124</span> pts/4    R+   <span class="token number">16</span>:38   <span class="token number">0</span>:00 <span class="token function">grep</span> <span class="token parameter variable">--color</span><span class="token operator">=</span>auto nginx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-10-验证nginx版本号-并进行访问测试" tabindex="-1"><a class="header-anchor" href="#_3-10-验证nginx版本号-并进行访问测试"><span>3.10 验证nginx版本号，并进行访问测试</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 查看版本号</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># /usr/local/nginx/1.14.2/sbin/nginx -v</span></span>
<span class="line">nginx version: nginx/1.22.0</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 访问测试</span></span>
<span class="line"><span class="token punctuation">[</span>root@iZ2zear1vazpz6ydchstjnZ nginx-1.22.0<span class="token punctuation">]</span><span class="token comment"># curl http://localhost:81</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>head<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>style<span class="token operator">&gt;</span></span>
<span class="line">  body <span class="token punctuation">{</span></span>
<span class="line">      width: 35em<span class="token punctuation">;</span></span>
<span class="line">      margin: <span class="token number">0</span> auto<span class="token punctuation">;</span></span>
<span class="line">      font-family: Tahoma, Verdana, Arial, sans-serif<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token operator">&lt;</span>/style<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>/head<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>If you see this page, the nginx web server is successfully installed and</span>
<span class="line">working. Further configuration is required.<span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>For online documentation and support please refer to</span>
<span class="line"><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://nginx.org/&quot;</span><span class="token operator">&gt;</span>nginx.org<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>br/<span class="token operator">&gt;</span></span>
<span class="line">Commercial support is available at</span>
<span class="line"><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://nginx.com/&quot;</span><span class="token operator">&gt;</span>nginx.com<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token operator">&lt;</span>em<span class="token operator">&gt;</span>Thank you <span class="token keyword">for</span> using nginx.<span class="token operator">&lt;</span>/em<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>/body<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>/html<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1179131421@qq.com">文铁铁~</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/static/tang/server/CentOS7%E5%AE%89%E8%A3%85redis.html" aria-label="CentOS7安装redis"><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span>CentOS7安装redis</span></div></a><a class="route-link auto-link next" href="/static/tang/server/%E5%80%9F%E5%8A%A9%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BD%BF%E7%94%A8frp%E5%81%9A%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F.html" aria-label="借助阿里云服务器使用frp做内网穿透"><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span>借助阿里云服务器使用frp做内网穿透</span></div></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CQavEA7Q.js" defer></script>
  </body>
</html>
