"use strict";(self.webpackChunkmy_doc=self.webpackChunkmy_doc||[]).push([["9602"],{60770:function(e,n,d){d.r(n),d.d(n,{default:()=>N});var r=d("85893"),i=d("50065");let s=d.p+"static/image/mapping_create.d24e6860.png",c=d.p+"static/image/mapping_search.ba424e6f.png",h=d.p+"static/image/doc_batch_delete.aa85100d.png",l=d.p+"static/image/doc_batch_create_error.489e4be7.png",a=d.p+"static/image/doc_batch_create_correct.7e3d9c87.png",t=d.p+"static/image/doc_delete_com.ba7e15d8.png",x=d.p+"static/image/doc_delete.fa3d5a45.png",j=d.p+"static/image/doc_update_field.398ccbd6.png",p=d.p+"static/image/doc_update.71736059.png",o=d.p+"static/image/doc_search.84cb4bad.png",m=d.p+"static/image/doc_create.b9aa6525.png",g=d.p+"static/image/index_delete.cf062630.png",u=d.p+"static/image/index_search_one.0d48f268.png",_=d.p+"static/image/index_search_all.61dda159.png",b=d.p+"static/image/index_create_with_shards.bbe80457.png",f=d.p+"static/image/index_create.7da40097.png";function k(e){let n=Object.assign({h1:"h1",a:"a",h2:"h2",p:"p",h3:"h3",blockquote:"blockquote",pre:"pre",code:"code",img:"img",strong:"strong",ul:"ul",li:"li",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td"},(0,i.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"4-es基本操作",children:["4 es基本操作",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#4-es基本操作",children:"#"})]}),"\n",(0,r.jsxs)(n.h2,{id:"41-分词器",children:["4.1 分词器",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#41-分词器",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"常用的是ik中文分词器。"}),"\n",(0,r.jsxs)(n.h2,{id:"42-索引操作",children:["4.2 索引操作",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#42-索引操作",children:"#"})]}),"\n",(0,r.jsxs)(n.h3,{id:"421-创建索引",children:["4.2.1 创建索引",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#421-创建索引",children:"#"})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"直接指定索引名"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"PUT /索引名\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:f,alt:""})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"指定主副分片数"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"分片只有在集群中才有效果，且主副分片分布在不同节点中。"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'// 当未指定主副分片时，es7.X均默认为1\r\nPUT /索引名\r\n{\r\n  "settings": {\r\n    "number_of_shards": 3, // 分片数\r\n    "number_of_replicas": 2 // 备份数\r\n  }\r\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:b,alt:""})}),"\n",(0,r.jsxs)(n.h3,{id:"422-查看索引",children:["4.2.2 查看索引",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#422-查看索引",children:"#"})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"查看所有索引"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"GET /_cat/indices?v\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:_,alt:""})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"查单个索引"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"GET /索引名\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:u,alt:""})}),"\n",(0,r.jsxs)(n.h3,{id:"423-删除索引",children:["4.2.3 删除索引",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#423-删除索引",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"DELETE /索引名\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:g,alt:""})}),"\n",(0,r.jsxs)(n.h2,{id:"43-文档操作",children:["4.3 文档操作",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#43-文档操作",children:"#"})]}),"\n",(0,r.jsxs)(n.h3,{id:"431-创建文档",children:["4.3.1 创建文档",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#431-创建文档",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"PUT /索引名/类型/id\r\n{\r\n    json类型的数据\r\n}\r\n// 类型：默认为_doc\r\n// id： 文档的主键\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:m,alt:""})}),"\n",(0,r.jsxs)(n.h3,{id:"432-查看文档",children:["4.3.2 查看文档",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#432-查看文档",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"GET /索引名/类型/id\r\n// 类型：默认为_doc\r\n// id： 文档的主键\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:o,alt:""})}),"\n",(0,r.jsxs)(n.h3,{id:"433-修改文档",children:["4.3.3 修改文档",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#433-修改文档",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"PUT /索引名/类型/id\r\n{\r\n    json类型的数据\r\n}\r\n// 类型：默认为_doc\r\n// id： 文档的主键\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:p,alt:""})}),"\n",(0,r.jsxs)(n.h3,{id:"434-修改局部属性",children:["4.3.4 修改局部属性",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#434-修改局部属性",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'POST /索引名/_update/id\r\n{\r\n    "doc" {\r\n        "属性名": "属性值"\r\n    }\r\n}\r\n\r\n// id： 文档的主键\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:j,alt:""})}),"\n",(0,r.jsxs)(n.h3,{id:"435-删除文档",children:["4.3.5 删除文档",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#435-删除文档",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"DELETE /索引名/类型/id\r\n\r\n// 类型：默认为_doc\r\n// id： 文档的主键\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:x,alt:""})}),"\n",(0,r.jsx)(n.p,{children:"注意："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"删除后，调用文档查看接口，返回的found值为false"}),"\n",(0,r.jsx)(n.li,{children:"调用查询所有索引接口，可看到当前索引下的文档数为1。"}),"\n",(0,r.jsxs)(n.li,{children:["以上说明，",(0,r.jsx)(n.strong,{children:"执行删除文档操作后，es并没有立刻将数据删除"}),"。\r\n",(0,r.jsx)("img",{src:t,alt:""})]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"436-批量操作",children:["4.3.6 批量操作",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#436-批量操作",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'POST _bulk\r\n{"actionName": {"index": "indexName","type": "typeName","_id": "id"}}\r\n{"field1": "value1","field2": "value2",...}\r\n{"actionName": {"index": "indexName","type": "typeName","_id": "id"}}\r\n{"field1": "value1","field2": "value2",...}\r\n...\r\n// actionName：create、delete等增删改查都可以\r\n// index： 值为索引名称\r\n// type： 可省\r\n// _id： 索引id\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"注意：以上单个json对象不允许换行"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"批量添加"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)("img",{src:a,alt:""}),"\r\n",(0,r.jsx)("img",{src:l,alt:""})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"批量删除"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:h,alt:""})}),"\n",(0,r.jsxs)(n.h2,{id:"44-映射",children:["4.4 映射",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#44-映射",children:"#"})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"概念"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"有了索引，就相当于有了数据库中的database。"}),"\n",(0,r.jsx)(n.p,{children:"索引库中的映射，类似于database中的表结构（table）。创建数据库表需要设置字段名称、类型、长度、约束等，索引库也一样，需要知道这个类型下有哪些字段，每个字段都有哪些约束信息，这就叫做映射。"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"映射是可以自动创建的。"})," 在向文档中插入第一条数据的时候，默认创建映射。"]}),"\n",(0,r.jsxs)(n.h3,{id:"441-查看映射",children:["4.4.1 查看映射",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#441-查看映射",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"GET /索引名/_mapping\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:c,alt:""})}),"\n",(0,r.jsxs)(n.h3,{id:"442-动态映射",children:["4.4.2 动态映射",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#442-动态映射",children:"#"})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"概念"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["映射是可以自动创建的。在文档写入ES时，会根据文档字段",(0,r.jsx)(n.strong,{children:"自动识别类型"}),"，这种机制被称为",(0,r.jsx)(n.strong,{children:"动态映射"}),"。"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"映射规则对应"}),"\n"]}),"\n",(0,r.jsxs)(n.table,{children:["\n",(0,r.jsxs)(n.thead,{children:["\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.th,{children:"数据"}),"\n",(0,r.jsx)(n.th,{children:"对应类型"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.tbody,{children:["\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.td,{children:"null"}),"\n",(0,r.jsx)(n.td,{children:"字段不添加"}),"\n"]}),"\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.td,{children:"true或false"}),"\n",(0,r.jsx)(n.td,{children:"boolean"}),"\n"]}),"\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.td,{children:"字符串"}),"\n",(0,r.jsx)(n.td,{children:"text"}),"\n"]}),"\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.td,{children:"数值"}),"\n",(0,r.jsx)(n.td,{children:"long"}),"\n"]}),"\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.td,{children:"小数"}),"\n",(0,r.jsx)(n.td,{children:"float"}),"\n"]}),"\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.td,{children:"日期"}),"\n",(0,r.jsx)(n.td,{children:"date"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"注意"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"很少有使用动态映射的"}),"\n",(0,r.jsxs)(n.h3,{id:"443-静态映射",children:["4.4.3 静态映射",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#443-静态映射",children:"#"})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"概念"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"静态映射是指在ES中事先定义好映射，即手动映射，包含文档的各终端类型、分词器等，这就是静态映射。"}),"\n",(0,r.jsx)(n.p,{children:"一般都会选择使用静态映射。"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"创建映射举例"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:s,alt:""})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"说明：type分类如下"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["字符串类型：text（支持分词）、keyword（不支持分词）","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"text：字符串类型。该类型被用来索引长文本，在创建索引前就会将这些文本进行分词，转化为词的组合，建立索引；允许es来检索这些词，text类型不能用来排序和聚合。"}),"\n",(0,r.jsx)(n.li,{children:"keyword：字符串类型。该类型不能分词，可以被用来检索过滤、排序和聚合。keyword不可用text进行分词模糊检索。"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"数值型：long、integer、short、byte、double、float"}),"\n",(0,r.jsx)(n.li,{children:"日期型：date"}),"\n",(0,r.jsx)(n.li,{children:"布尔型：boolean"}),"\n"]})]})}function E(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(k,{...e})}):k(e)}let N=E;E.__RSPRESS_PAGE_META={},E.__RSPRESS_PAGE_META["tang%2FElasticsearch%2F04_Elasticsearch%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C.md"]={toc:[{text:"4.1 分词器",id:"41-分词器",depth:2},{text:"4.2 索引操作",id:"42-索引操作",depth:2},{text:"4.2.1 创建索引",id:"421-创建索引",depth:3},{text:"4.2.2 查看索引",id:"422-查看索引",depth:3},{text:"4.2.3 删除索引",id:"423-删除索引",depth:3},{text:"4.3 文档操作",id:"43-文档操作",depth:2},{text:"4.3.1 创建文档",id:"431-创建文档",depth:3},{text:"4.3.2 查看文档",id:"432-查看文档",depth:3},{text:"4.3.3 修改文档",id:"433-修改文档",depth:3},{text:"4.3.4 修改局部属性",id:"434-修改局部属性",depth:3},{text:"4.3.5 删除文档",id:"435-删除文档",depth:3},{text:"4.3.6 批量操作",id:"436-批量操作",depth:3},{text:"4.4 映射",id:"44-映射",depth:2},{text:"4.4.1 查看映射",id:"441-查看映射",depth:3},{text:"4.4.2 动态映射",id:"442-动态映射",depth:3},{text:"4.4.3 静态映射",id:"443-静态映射",depth:3}],title:"4 es基本操作",frontmatter:{}}}}]);