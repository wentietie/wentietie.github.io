import{_ as o,r as t,o as r,a as c,b as s,e,F as l,c as p,d as n}from"./app.a1031244.js";var i="/assets/image-20210926173948018.dc7501fe.png",k="/assets/image-20210926174422445.3e518a7c.png",u="/assets/image-20210927143258137.17b0dcc0.png",m="/assets/image-20210927151040966.79350101.png",b="/assets/image-20210927164301904.028a0257.png",d="/assets/image-20210927164615544.dbc88872.png",h="/assets/image-20210927163554140.71ed4cee.png",f="/assets/image-20210927163700269.f00aa87c.png",g="/assets/image-20210927165146601.41fb59a8.png",v="/assets/image-20210927165458817.883e3fa2.png",w="/assets/image-20210927170033213.ed2341ea.png",_="/assets/image-20210927170100944.912b58fe.png";const y={},q=p('<h1 id="docker-\u8FDB\u9636" tabindex="-1"><a class="header-anchor" href="#docker-\u8FDB\u9636" aria-hidden="true">#</a> Docker \u8FDB\u9636</h1><h2 id="docker-compose" tabindex="-1"><a class="header-anchor" href="#docker-compose" aria-hidden="true">#</a> Docker Compose</h2><p><code>[DaoCloud | Docker \u6781\u901F\u4E0B\u8F7D](http://get.daocloud.io/)</code></p><h3 id="\u7B80\u4ECB" tabindex="-1"><a class="header-anchor" href="#\u7B80\u4ECB" aria-hidden="true">#</a> \u7B80\u4ECB</h3><p>\u901A\u8FC7YAML\u6587\u4EF6\uFF0C\u5B9A\u4E49\u3001\u8FD0\u884C\u591A\u4E2A\u5BB9\u5668\u3002</p><blockquote><p>\u4F7F\u7528Docker Compose\u7684\u4E09\u6B65\u9AA4\uFF1A</p></blockquote><p>1.\u5B9A\u4E49Dockerfile\u6587\u4EF6\u3002</p><p>2.\u7F16\u5199docker-compose.yaml\u6587\u4EF6</p><p>3.\u542F\u52A8\u9879\u76EE</p><blockquote><p>\u72C2\u795E\u8BF4</p></blockquote><p>Compose\u662FDocker\u5B98\u65B9\u5F00\u6E90\u9879\u76EE\uFF0C\u9700\u8981\u5B89\u88C5\uFF01</p><p>Compose\u91CD\u8981\u6982\u5FF5\uFF1A</p><ul><li>\u670D\u52A1Services\uFF1A\u5355\u4E2A\u7684\u5BB9\u5668/\u5E94\u7528</li><li>\u9879\u76EEProject\uFF1A\u4E00\u7EC4\u5173\u8054\u7684\u5BB9\u5668</li></ul><p><code>\u5927\u795E\u798F\u5229\u770B</code></p><h3 id="\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5" aria-hidden="true">#</a> \u5B89\u88C5</h3><p>1.\u4E0B\u8F7D</p><p>\u53EF\u4EE5\u5728http://get.daocloud.io/ \u7F51\u7AD9\u4E2D\u627E\u5230\u56FD\u5185\u4E0B\u8F7D\u5730\u5740</p><p><img src="'+i+'" alt="image-20210926173948018"></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">curl</span> -L https://get.daocloud.io/docker/compose/releases/download/1.29.2/docker-compose-<span class="token variable"><span class="token variable">`</span><span class="token function">uname</span> -s<span class="token variable">`</span></span>-<span class="token variable"><span class="token variable">`</span><span class="token function">uname</span> -m<span class="token variable">`</span></span> <span class="token operator">&gt;</span> /usr/local/bin/docker-compose\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>2.\u6388\u6743</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">chmod</span> +x /usr/local/bin/docker-compose\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>3.\u9A8C\u8BC1\u662F\u5426\u5B89\u88C5\u6210\u529F</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker-compose</span> --version\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+k+'" alt="image-20210926174422445"></p><h3 id="\u4F53\u9A8C" tabindex="-1"><a class="header-anchor" href="#\u4F53\u9A8C" aria-hidden="true">#</a> \u4F53\u9A8C</h3>',25),x=n("\u5B98\u65B9python\u8BA1\u6570\u5668\u5E94\u7528\u3002"),j={href:"https://docs.docker.com/compose/gettingstarted/",target:"_blank",rel:"noopener noreferrer"},A=n("Get started with Docker Compose | Docker Documentation"),S=n("\u642D\u5EFAWordPress\u535A\u5BA2\u5E94\u7528\u3002"),D={href:"https://docs.docker.com/samples/wordpress/",target:"_blank",rel:"noopener noreferrer"},R=n("Quickstart: Compose and WordPress | Docker Documentation"),T=s("h2",{id:"docker-swarm",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#docker-swarm","aria-hidden":"true"},"#"),n(" Docker Swarm")],-1),E={href:"https://docs.docker.com/engine/swarm/how-swarm-mode-works/nodes/",target:"_blank",rel:"noopener noreferrer"},N=n("How nodes work | Docker Documentation"),I=p(`<h3 id="\u5B89\u88C5-1" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5-1" aria-hidden="true">#</a> \u5B89\u88C5</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u51C6\u5907\u597D4\u53F0\u865A\u62DF\u673A\uFF08centos7.8\u7CFB\u7EDF\uFF09\uFF0C3\u53F0\u7528\u4F5Cmaster\u8282\u70B9\uFF0810.1.93.40, 10.1.93.42, 10.1.93.43\uFF09\uFF0C\u4E00\u53F0\u7528\u4F5Cnode\u8282\u70B9\uFF0810.1.93.44\uFF09</span>

<span class="token comment"># \u5173\u95ED\u865A\u62DF\u673A\u9632\u706B\u5899</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># systemctl stop firewalld</span>
<span class="token comment"># \u5F00\u673A\u4E0D\u542F\u52A8\u9632\u706B\u5899</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># systemctl disable firewalld</span>
Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.
Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.

<span class="token comment"># \u8BBE\u7F6E\u4E3B\u673A\u540D\u5206\u522B\u4E3Amaster1\u3001master2\u3001master3\u3001node\uFF08\u4EE5master1\u4E3A\u4F8B\uFF09</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># hostnamectl set-hostname master1</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># hostname</span>
master1


<span class="token comment"># \u67E5\u770Bdocker swarm \u5E2E\u52A9\u6587\u6863</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker swarm --help</span>

Usage:  <span class="token function">docker</span> swarm COMMAND

Manage Swarm

Commands:
  ca          Display and rotate the root CA
  init        Initialize a swarm <span class="token comment"># \u521D\u59CB\u5316docker swarm</span>
  <span class="token function">join</span>        Join a swarm as a <span class="token function">node</span> and/or manager <span class="token comment"># \u5728docker swarm\u96C6\u7FA4\u4E2D\u5047\u5982\u4E00\u4E2Anode\uFF08\u5DE5\u4F5C\uFF09\u8282\u70B9\u6216\u8005manager\uFF08\u7BA1\u7406\uFF09\u8282\u70B9</span>
  join-token  Manage <span class="token function">join</span> tokens <span class="token comment"># \u7BA1\u7406\u52A0\u5165swarm\u96C6\u7FA4\u7684token</span>
  leave       Leave the swarm <span class="token comment"># \u79BB\u5F00swarm\u96C6\u7FA4</span>
  unlock      Unlock swarm
  unlock-key  Manage the unlock key
  update      Update the swarm

Run <span class="token string">&#39;docker swarm COMMAND --help&#39;</span> <span class="token keyword">for</span> <span class="token function">more</span> information on a command.

<span class="token comment"># \u67E5\u770Bswarm\u521D\u59CB\u5316\u547D\u4EE4\u7684\u5E2E\u52A9\u6587\u6863</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker swarm init --help</span>

Usage:  <span class="token function">docker</span> swarm init <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span>

Initialize a swarm

Options:
      --advertise-addr string                  Advertised address <span class="token punctuation">(</span>format: <span class="token operator">&lt;</span>ip<span class="token operator">|</span>interface<span class="token operator">&gt;</span><span class="token punctuation">[</span>:port<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># \u8282\u70B9\u7684ip</span>
      --autolock                               Enable manager autolocking <span class="token punctuation">(</span>requiring an unlock key to start a stopped manager<span class="token punctuation">)</span>
      --availability string                    Availability of the <span class="token function">node</span> <span class="token punctuation">(</span><span class="token string">&quot;active&quot;</span><span class="token operator">|</span><span class="token string">&quot;pause&quot;</span><span class="token operator">|</span><span class="token string">&quot;drain&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>default <span class="token string">&quot;active&quot;</span><span class="token punctuation">)</span>
      --cert-expiry duration                   Validity period <span class="token keyword">for</span> <span class="token function">node</span> certificates <span class="token punctuation">(</span>ns<span class="token operator">|</span>us<span class="token operator">|</span>ms<span class="token operator">|</span>s<span class="token operator">|</span>m<span class="token operator">|</span>h<span class="token punctuation">)</span> <span class="token punctuation">(</span>default 2160h0m0s<span class="token punctuation">)</span>
      --data-path-addr string                  Address or interface to use <span class="token keyword">for</span> data path traffic <span class="token punctuation">(</span>format: <span class="token operator">&lt;</span>ip<span class="token operator">|</span>interface<span class="token operator">&gt;</span><span class="token punctuation">)</span>
      --data-path-port uint32                  Port number to use <span class="token keyword">for</span> data path traffic <span class="token punctuation">(</span><span class="token number">1024</span> - <span class="token number">49151</span><span class="token punctuation">)</span>. If no value is <span class="token builtin class-name">set</span> or is <span class="token builtin class-name">set</span> to <span class="token number">0</span>, the default port <span class="token punctuation">(</span><span class="token number">4789</span><span class="token punctuation">)</span> is used.
      --default-addr-pool ipNetSlice           default address pool <span class="token keyword">in</span> CIDR <span class="token function">format</span> <span class="token punctuation">(</span>default <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      --default-addr-pool-mask-length uint32   default address pool subnet mask length <span class="token punctuation">(</span>default <span class="token number">24</span><span class="token punctuation">)</span>
      --dispatcher-heartbeat duration          Dispatcher heartbeat period <span class="token punctuation">(</span>ns<span class="token operator">|</span>us<span class="token operator">|</span>ms<span class="token operator">|</span>s<span class="token operator">|</span>m<span class="token operator">|</span>h<span class="token punctuation">)</span> <span class="token punctuation">(</span>default 5s<span class="token punctuation">)</span>
      --external-ca external-ca                Specifications of one or <span class="token function">more</span> certificate signing endpoints
      --force-new-cluster                      Force create a new cluster from current state
      --listen-addr node-addr                  Listen address <span class="token punctuation">(</span>format: <span class="token operator">&lt;</span>ip<span class="token operator">|</span>interface<span class="token operator">&gt;</span><span class="token punctuation">[</span>:port<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>default <span class="token number">0.0</span>.0.0:2377<span class="token punctuation">)</span>
      --max-snapshots uint                     Number of additional Raft snapshots to retain
      --snapshot-interval uint                 Number of log entries between Raft snapshots <span class="token punctuation">(</span>default <span class="token number">10000</span><span class="token punctuation">)</span>
      --task-history-limit int                 Task <span class="token function">history</span> retention limit <span class="token punctuation">(</span>default <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># ip a s</span>
<span class="token number">1</span>: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class="token number">1000</span>
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet <span class="token number">127.0</span>.0.1/8 scope <span class="token function">host</span> lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope <span class="token function">host</span>
       valid_lft forever preferred_lft forever
<span class="token number">2</span>: enp0s3: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc pfifo_fast state UP group default qlen <span class="token number">1000</span>
    link/ether 08:00:27:12:b7:b0 brd ff:ff:ff:ff:ff:ff
    inet <span class="token number">10.1</span>.93.12/24 brd <span class="token number">10.1</span>.93.255 scope global noprefixroute dynamic enp0s3
       valid_lft 28641sec preferred_lft 28641sec
    inet <span class="token number">10.1</span>.93.40/24 brd <span class="token number">10.1</span>.93.255 scope global secondary noprefixroute enp0s3
       valid_lft forever preferred_lft forever
    inet6 fe80::8f66:341c:c632:dbe/64 scope <span class="token function">link</span> tentative noprefixroute dadfailed
       valid_lft forever preferred_lft forever
    inet6 fe80::11b0:6c7b:f3d5:528/64 scope <span class="token function">link</span> tentative noprefixroute dadfailed
       valid_lft forever preferred_lft forever
    inet6 fe80::a259:11c5:d707:87d6/64 scope <span class="token function">link</span> tentative noprefixroute dadfailed
       valid_lft forever preferred_lft forever
<span class="token number">3</span>: docker0: <span class="token operator">&lt;</span>NO-CARRIER,BROADCAST,MULTICAST,UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc noqueue state DOWN group default
    link/ether 02:42:13:36:ad:88 brd ff:ff:ff:ff:ff:ff
    inet <span class="token number">172.17</span>.0.1/16 brd <span class="token number">172.17</span>.255.255 scope global docker0
       valid_lft forever preferred_lft forever
       
<span class="token comment"># \u521D\u59CB\u5316swarm\u96C6\u7FA4</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker swarm init --advertise-addr 10.1.93.40</span>
Swarm initialized: current <span class="token function">node</span> <span class="token punctuation">(</span>u0bt4gq1cjcbrr5sm75w7btmg<span class="token punctuation">)</span> is now a manager. <span class="token comment"># swarm\u521D\u59CB\u5316\uFF0C\u5F53\u524D\u8282\u70B9\u662F\u4E00\u4E2Amanager\u8282\u70B9</span>

To <span class="token function">add</span> a worker to this swarm, run the following command: <span class="token comment"># \u5982\u679C\u60F3\u8981\u52A0\u5165\u4E00\u4E2Aworker\uFF08\u5DE5\u4F5C\uFF09\u8282\u70B9\uFF0C\u5C31\u6267\u884C\u4E0B\u9762\u7684\u547D\u4EE4</span>

    <span class="token function">docker</span> swarm <span class="token function">join</span> --token SWMTKN-1-0sal3yuz8pf9fqku0q284jpwonbulc1auelurkcikqhyqhk91q-bp090fqdn83y8tu0340xjty5n <span class="token number">10.1</span>.93.40:2377

To <span class="token function">add</span> a manager to this swarm, run <span class="token string">&#39;docker swarm join-token manager&#39;</span> and follow the instructions. <span class="token comment"># \u5982\u679C\u60F3\u8981\u52A0\u5165\u4E00\u4E2Amanager\u8282\u70B9\uFF0C\u6267\u884C\u8BE5\u547D\u4EE4\u6765\u83B7\u53D6\u4EE4\u724C\u3002</span>

<span class="token comment"># \u83B7\u53D6worker\u8282\u70B9\u4EE4\u724C docker swarm join-token worker</span>

<span class="token comment"># \u83B7\u53D6manager\u8282\u70B9\u4EE4\u724C docker swarm join-token manager</span>


<span class="token comment"># \u52A0\u5165node\u8282\u70B9\uFF08\u5728node\u8282\u70B9\u4E2D\u6267\u884C\uFF09</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker swarm join --token SWMTKN-1-0sal3yuz8pf9fqku0q284jpwonbulc1auelurkcikqhyqhk91q-bp090fqdn83y8tu0340xjty5n 10.1.93.40:2377</span>
This <span class="token function">node</span> joined a swarm as a worker.
<span class="token comment"># \u67E5\u770Bnode\u8282\u70B9\u662F\u5426\u52A0\u5165\u6210\u529F\uFF08\u5728master1\u8282\u70B9\u4E2D\u6267\u884C\uFF09</span>
root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker node ls</span>
ID                            <span class="token environment constant">HOSTNAME</span>   STATUS    AVAILABILITY   MANAGER STATUS   ENGINE VERSION
u0bt4gq1cjcbrr5sm75w7btmg *   master1    Ready     Active         Leader           <span class="token number">20.10</span>.8
ygfjk8z1o38ojxcp9bmh8djxs     <span class="token function">node</span>       Ready     Active                          <span class="token number">20.10</span>.8
<span class="token comment"># \u65B0\u589Enode\uFF0Cnode\u8282\u70B9\u52A0\u5165\u6210\u529F</span>

<span class="token comment"># \u52A0\u5165manager\u8282\u70B9</span>
<span class="token comment"># \u83B7\u53D6manager\u8282\u70B9\u4EE4\u724C\uFF08\u5728master\u8282\u70B9\u4E2D\u6267\u884C\uFF09</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker swarm join-token manager</span>
To <span class="token function">add</span> a manager to this swarm, run the following command:

    <span class="token function">docker</span> swarm <span class="token function">join</span> --token SWMTKN-1-0sal3yuz8pf9fqku0q284jpwonbulc1auelurkcikqhyqhk91q-5ruytdhj863jahojyzd0h031g <span class="token number">10.1</span>.93.40:2377
<span class="token comment"># \u52A0\u5165master2\uFF08\u5728master2\u4E2D\u6267\u884C\uFF09</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker swarm join --token SWMTKN-1-0sal3yuz8pf9fqku0q284jpwonbulc1auelurkcikqhyqhk91q-5ruytdhj863jahojyzd0h031g 10.1.93.40:2377</span>
This <span class="token function">node</span> joined a swarm as a manager.
<span class="token comment"># \u52A0\u5165master3\uFF08\u5728master3\u4E2D\u6267\u884C\uFF09</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker swarm join --token SWMTKN-1-0sal3yuz8pf9fqku0q284jpwonbulc1auelurkcikqhyqhk91q-5ruytdhj863jahojyzd0h031g 10.1.93.40:2377</span>
This <span class="token function">node</span> joined a swarm as a manager.
<span class="token comment"># \u67E5\u770Bmanager\u8282\u70B9\u662F\u5426\u52A0\u5165\u6210\u529F\uFF08\u5728master1\u8282\u70B9\u4E2D\u6267\u884C\uFF09</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker node ls</span>
ID                            <span class="token environment constant">HOSTNAME</span>   STATUS    AVAILABILITY   MANAGER STATUS   ENGINE VERSION
u0bt4gq1cjcbrr5sm75w7btmg *   master1    Ready     Active         Leader           <span class="token number">20.10</span>.8
eumyzjkk6y8hy3qiw1fdiu6nm     master2    Ready     Active         Reachable        <span class="token number">20.10</span>.8
jjcybt4dhej1tfl9zmhatnvzi     master3    Ready     Active         Reachable        <span class="token number">20.10</span>.8
ygfjk8z1o38ojxcp9bmh8djxs     <span class="token function">node</span>       Ready     Active                          <span class="token number">20.10</span>.8
<span class="token comment"># \u65B0\u589Emaster2\uFF0C master3\uFF0C\u4E24\u4E2Amaster\u8282\u70B9\u52A0\u5165\u6210\u529F</span>
<span class="token comment"># \u81F3\u6B64\uFF0C\u96C6\u7FA4\u642D\u5EFA\u5B8C\u6BD5</span>
<span class="token comment"># \u53EA\u6709\u7BA1\u7406\u8282\u70B9\u624D\u80FD\u6267\u884Cdocker swarm\u547D\u4EE4.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br></div></div><h3 id="raft\u534F\u8BAE" tabindex="-1"><a class="header-anchor" href="#raft\u534F\u8BAE" aria-hidden="true">#</a> Raft\u534F\u8BAE</h3><p><img src="`+u+'" alt="image-20210927143258137"></p><blockquote><p>\u5B9A\u4E49\uFF1A\u4FDD\u8BC1\u5927\u591A\u6570\u8282\u70B9\u5B58\u6D3B\u624D\u53EF\u4EE5\u4F7F\u7528\u3002</p></blockquote><p>\u5982\u679C\u4E24\u4E3B\u4E24\u4ECE\uFF0C\u6302\u4E86\u4E00\u4E2A\u4E3B\u8282\u70B9\uFF0C\u53E6\u5916\u4E00\u4E2A\u4E3B\u8282\u70B9\u4E5F\u4E0D\u80FD\u7528\u4E86\u3002</p><p>\u5982\u679C\u4E09\u4F4F\u4E00\u4ECE\uFF0C\u6302\u4E86\u4E00\u4E2A\u4E3B\u8282\u70B9\uFF0C\u53E6\u5916\u4E24\u4E2A\u53EF\u4EE5\u4F7F\u7528\uFF1B\u5982\u679C\u6302\u4E86\u4E24\u4E2A\u4E3B\u8282\u70B9\uFF0C\u53E6\u5916\u4E00\u4E2A\u4E5F\u4E0D\u80FD\u7528\u4E86\u3002</p><h3 id="\u4F53\u4F1A" tabindex="-1"><a class="header-anchor" href="#\u4F53\u4F1A" aria-hidden="true">#</a> \u4F53\u4F1A</h3><p>\u53EF\u4EE5\u7C7B\u6BD4k8s\u3002</p><p>\u547D\u4EE4\uFF1A<code>docker service</code></p><p><img src="'+m+`" alt="image-20210927151040966"></p><h4 id="\u521B\u5EFA\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFA\u670D\u52A1" aria-hidden="true">#</a> \u521B\u5EFA\u670D\u52A1</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u542F\u52A8nginx\u670D\u52A1</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker service create -p 8888:80 --name my-nginx nginx</span>
3ab10q4uk6ujhiukrelj8i804
overall progress: <span class="token number">1</span> out of <span class="token number">1</span> tasks
<span class="token number">1</span>/1: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
verify: Service converged

<span class="token comment"># \u67E5\u770B\u670D\u52A1\u5217\u8868</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker service ls</span>
ID             NAME       MODE         REPLICAS   IMAGE          PORTS
3ab10q4uk6uj   my-nginx   replicated   <span class="token number">1</span>/1        nginx:latest   *:8888-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp

<span class="token comment"># \u67E5\u770B\u670D\u52A1\u8FD0\u884C\u72B6\u6001</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker service ps my-nginx</span>
ID             NAME         IMAGE          NODE      DESIRED STATE   CURRENT STATE           ERROR     PORTS
89duy7m0qs22   my-nginx.1   nginx:latest   master1   Running         Running <span class="token number">4</span> minutes ago
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><blockquote><p>dokcer run \u548C docker service \u5BF9\u6BD4\uFF1A</p></blockquote><ul><li>docker run\uFF1A\u5BB9\u5668\u542F\u52A8\uFF0C\u5355\u673A\u7248\uFF0C\u4E0D\u5177\u6709\u6269\u7F29\u5BB9\u529F\u80FD</li><li>docker service\uFF1A\u670D\u52A1\u542F\u52A8\uFF0C\u96C6\u7FA4\u64CD\u4F5C\uFF0C\u5177\u6709\u6269\u7F29\u5BB9\u529F\u80FD</li></ul><p>==docker swarm\u521B\u5EFA\u7684\u670D\u52A1\u968F\u673A\u5206\u914D\u5230\u5404\u4E2A\u8282\u70B9\u4E0A\uFF0C\u5305\u62ECmaster\u8282\u70B9\u548Cnode\u8282\u70B9==</p><blockquote><p>\u526F\u672C\u670D\u52A1\u4E0E\u5168\u5C40\u670D\u52A1</p></blockquote><p><img src="`+b+'" alt="image-20210927164301904"></p><ul><li>\u526F\u672C\u670D\u52A1\uFF1A\u53EA\u8FD0\u884C\u5728worker\u8282\u70B9\u4E0A</li><li>\u5168\u5C40\u670D\u52A1\uFF1A\u65E2\u53EF\u8FD0\u884C\u5728worker\u8282\u70B9\u4E0A\uFF0C\u53C8\u53EF\u8FD0\u884C\u5728manager\u8282\u70B9\u4E0A\u3002\u9ED8\u8BA4\u4E3A\u5168\u5C40\u670D\u52A1</li></ul><p>==\u53EF\u4EE5\u4F7F\u7528--mode\u8BBE\u7F6E\u670D\u52A1\u89C4\u5219==</p><p><img src="'+d+`" alt="image-20210927164615544"></p><h4 id="\u52A8\u6001\u6269\u7F29\u5BB9" tabindex="-1"><a class="header-anchor" href="#\u52A8\u6001\u6269\u7F29\u5BB9" aria-hidden="true">#</a> \u52A8\u6001\u6269\u7F29\u5BB9</h4><blockquote><p>\u4E24\u79CD\u65B9\u6CD5</p></blockquote><ul><li>docker service update --replicas</li><li>docker service scale</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u4F7F\u7528 docker service update --replicas \u5C06my-nginx\u6269\u5C55\u4E3A3\u4E2A\u526F\u672C</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker service update --replicas 3 my-nginx</span>
my-nginx
overall progress: <span class="token number">3</span> out of <span class="token number">3</span> tasks
<span class="token number">1</span>/3: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
<span class="token number">2</span>/3: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
<span class="token number">3</span>/3: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
verify: Service converged

<span class="token comment"># \u67E5\u770B\u670D\u52A1\u5217\u8868</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker service ls</span>
ID             NAME       MODE         REPLICAS   IMAGE          PORTS
3ab10q4uk6uj   my-nginx   replicated   <span class="token number">3</span>/3        nginx:latest   *:8888-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp

<span class="token comment"># \u4F7F\u7528docker service scale \u5C06my-nginx\u6269\u5C55\u4E3A5\u4E2A\u526F\u672C</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker service scale my-nginx=5</span>
my-nginx scaled to <span class="token number">5</span>
overall progress: <span class="token number">5</span> out of <span class="token number">5</span> tasks
<span class="token number">1</span>/5: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
<span class="token number">2</span>/5: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
<span class="token number">3</span>/5: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
<span class="token number">4</span>/5: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
<span class="token number">5</span>/5: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
verify: Service converged

<span class="token comment"># \u67E5\u770B\u670D\u52A1\u5217\u8868</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker service ls</span>
ID             NAME       MODE         REPLICAS   IMAGE          PORTS
3ab10q4uk6uj   my-nginx   replicated   <span class="token number">5</span>/5        nginx:latest   *:8888-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>\u52A8\u6001\u66F4\u65B0</p><p>\u7070\u5EA6\u53D1\u5E03\uFF08\u91D1\u4E1D\u96C0\u53D1\u5E03\uFF09</p><h3 id="\u6982\u5FF5" tabindex="-1"><a class="header-anchor" href="#\u6982\u5FF5" aria-hidden="true">#</a> \u6982\u5FF5</h3><blockquote><p>task\uFF1A\u5BB9\u5668\u5185\u7684\u547D\u4EE4\uFF0C\u7EC6\u8282\u4EFB\u52A1\uFF01</p></blockquote><p>\u4E00\u4E2Aservice\u53EF\u521B\u5EFA\u591A\u4E2A\u526F\u672C\uFF0C\u6BCF\u4E2A\u526F\u672C\u90FD\u662F\u4E00\u4E2Atask\u4EFB\u52A1\uFF0C\u6BCF\u4E2Atask\u4EFB\u52A1\u4E2D\u8FD0\u884C\u4E00\u4E2A\u5BB9\u5668\u3002</p><p><img src="`+h+'" alt="image-20210927163554140"></p><h3 id="\u5185\u90E8\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u5185\u90E8\u539F\u7406" aria-hidden="true">#</a> \u5185\u90E8\u539F\u7406</h3><p><img src="'+f+'" alt="image-20210927163700269"></p><h3 id="\u7F51\u7EDC\u6A21\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u7F51\u7EDC\u6A21\u5F0F" aria-hidden="true">#</a> \u7F51\u7EDC\u6A21\u5F0F</h3><ul><li><p>Overlay\uFF1A\u4F7F\u5F97\u5404\u4E2A\u8282\u70B9\u80FD\u591Fping\u901A\uFF0C\u53D8\u6210\u4E00\u4E2A\u96C6\u7FA4\u3002</p></li><li><p>ingress\uFF1A\u7279\u6B8A\u7684Overlay\uFF0C\u5177\u6709\u8D1F\u8F7D\u5747\u8861\u7684\u529F\u80FD\u3002</p><p><img src="'+g+'" alt="image-20210927165146601"></p></li></ul><p><img src="'+v+`" alt="image-20210927165458817"></p><h2 id="docker-stack" tabindex="-1"><a class="header-anchor" href="#docker-stack" aria-hidden="true">#</a> Docker Stack</h2><p>docker-compose \u5355\u51FB\u90E8\u7F72\u9879\u76EE\u3002</p><p>Docker Stack \u96C6\u7FA4\u90E8\u7F72\u9879\u76EE\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5355\u51FB\u90E8\u7F72</span>
<span class="token function">docker-compose</span> up -d wordpress

<span class="token comment"># \u96C6\u7FA4\u90E8\u7F72</span>
<span class="token function">docker</span> stack deploy wordpress.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="docker-secret" tabindex="-1"><a class="header-anchor" href="#docker-secret" aria-hidden="true">#</a> Docker Secret</h2><p>\u5B89\u5168\uFF01\u914D\u7F6E\u5BC6\u7801\uFF0C\u8BC1\u4E66</p><p><img src="`+w+'" alt="image-20210927170033213"></p><h2 id="docker-config" tabindex="-1"><a class="header-anchor" href="#docker-config" aria-hidden="true">#</a> Docker Config</h2><p><img src="'+_+'" alt="image-20210927170100944"></p><h2 id="\u6269\u5C55\u5230k8s" tabindex="-1"><a class="header-anchor" href="#\u6269\u5C55\u5230k8s" aria-hidden="true">#</a> \u6269\u5C55\u5230K8S</h2><p><strong>\u4E91\u539F\u751F\u65F6\u4EE3</strong></p><p>\u8D85\u8FC710\u53F0\u670D\u52A1\u5668\uFF0C\u9996\u9009k8s\uFF0C\u800C\u975Edocker swarm\uFF01</p><p>\u5148\u638C\u63E1go\u8BED\u8A00\uFF0C\u5728\u5B66\u4E60k8s\u4F1A\u66F4\u597D\u3002</p><p>java\u5C31\u662F\u7528go\u8BED\u8A00\u5199\u7684\u3002</p><p>go\u7684\u6548\u7387\u63A5\u8FD1\u4E8Ec\u8BED\u8A00\u3002</p>',51);function M(O,C){const a=t("ExternalLinkIcon");return r(),c(l,null,[q,s("ul",null,[s("li",null,[x,s("a",j,[A,e(a)])]),s("li",null,[S,s("a",D,[R,e(a)])])]),T,s("p",null,[s("a",E,[N,e(a)])]),I],64)}var P=o(y,[["render",M],["__file","Docker.html.vue"]]);export{P as default};
