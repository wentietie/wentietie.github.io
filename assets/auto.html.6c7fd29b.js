import{_ as s,c as a}from"./app.222641c0.js";var n="/assets/k8s-jenkins-auto-python-1.afca2a1f.png",e="/assets/k8s-jenkins-auto-python-2.3dfb13bf.png",t="/assets/k8s-jenkins-auto-python-10.f3f66474.png",o="/assets/k8s-jenkins-auto-python-11.61133784.png",i="/assets/k8s-jenkins-auto-python-12.13a902f0.png",p="/assets/k8s-jenkins-auto-python-13.55441529.png",r="/assets/k8s-jenkins-auto-python-14.29bcf2a9.png",c="/assets/k8s-jenkins-auto-python-15.2ce222f1.png",l="/assets/k8s-jenkins-auto-python-3.1b4f4f9c.png",d="/assets/k8s-jenkins-auto-python-4.b5974d9b.png",h="/assets/k8s-jenkins-auto-python-5.b6e57f38.png",u="/assets/k8s-jenkins-auto-python-6.dd32a4d3.png",k="data:image/png;base64,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",b="/assets/k8s-jenkins-auto-python-8.47247bf0.png",g="/assets/k8s-jenkins-auto-python-9.c98ac932.png";const m={},f=a('<h1 id="\u81EA\u52A8\u90E8\u7F72" tabindex="-1"><a class="header-anchor" href="#\u81EA\u52A8\u90E8\u7F72" aria-hidden="true">#</a> \u81EA\u52A8\u90E8\u7F72</h1><h1 id="_1-\u63D2\u4EF6\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#_1-\u63D2\u4EF6\u51C6\u5907" aria-hidden="true">#</a> 1.\u63D2\u4EF6\u51C6\u5907</h1><p>\u5728jenkins\u7BA1\u7406\u754C\u9762\uFF0C\u70B9\u51FB<code>Manage Jenkins</code>\uFF0C\u9009\u62E9<code>Manage Plugins</code>\uFF0C\u70B9\u51FB<code>\u53EF\u9009\u63D2\u4EF6</code>\uFF0C\u641C\u7D22<code>GitLab Plugin</code>\u3001<code>Docker Plugin</code>\uFF0C\u76F4\u63A5\u5B89\u88C5\u3002</p><p><img src="'+n+'" alt="1614741687301"></p><h1 id="_2-\u670D\u52A1\u5668\u73AF\u5883\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_2-\u670D\u52A1\u5668\u73AF\u5883\u914D\u7F6E" aria-hidden="true">#</a> 2.\u670D\u52A1\u5668\u73AF\u5883\u914D\u7F6E</h1><h2 id="_2-1\u5B89\u88C5git" tabindex="-1"><a class="header-anchor" href="#_2-1\u5B89\u88C5git" aria-hidden="true">#</a> 2.1\u5B89\u88C5git</h2><p>\u56E0\u662F\u6BCF\u6B21git\u4E0A\u9879\u76EE\u6709\u66F4\u65B0\uFF0C\u90FD\u4F1A\u81EA\u52A8\u5236\u4F5C\u955C\u50CF\u3001\u5347\u7EA7\u670D\u52A1\u955C\u50CF\uFF0C\u6545\u88C5\u6709jenkins\u7684\u670D\u52A1\u5668\u9700\u8981\u5B89\u88C5git\u7528\u6765\u4E0B\u8F7Dgitlab\u4E0A\u7684\u9879\u76EE\u3002</p><h2 id="_2-2\u5B89\u88C5docker" tabindex="-1"><a class="header-anchor" href="#_2-2\u5B89\u88C5docker" aria-hidden="true">#</a> 2.2\u5B89\u88C5docker</h2><p>\u5236\u4F5C\u955C\u50CF\u7684\u65F6\u5019\uFF0C\u9700\u8981\u7528\u5230docker\uFF0C\u56E0\u6B64\u88C5\u6709jenkins\u7684\u670D\u52A1\u5668\u9700\u8981\u5B89\u88C5docker\u6765\u5B9E\u73B0\u955C\u50CF\u7684\u5236\u4F5C\u4E0E\u63A8\u9001\u7B49\u64CD\u4F5C\u3002</p><h1 id="_3-jenkins\u5168\u5C40\u5DE5\u5177\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_3-jenkins\u5168\u5C40\u5DE5\u5177\u914D\u7F6E" aria-hidden="true">#</a> 3.jenkins\u5168\u5C40\u5DE5\u5177\u914D\u7F6E</h1><p>\u5728jenkins\u7BA1\u7406\u754C\u9762\uFF0C\u70B9\u51FB<code>Manage Jenkins</code>\uFF0C\u9009\u62E9<code>Global Tool Configuration</code>\uFF0C\u70B9\u51FB<code>\u53EF\u9009\u63D2\u4EF6</code>\uFF0C\u641C\u7D22<code>GitLab Plugin</code>\u3001<code>Docker Plugin</code>\uFF0C\u76F4\u63A5\u5B89\u88C5\u3002</p><h2 id="_3-1\u914D\u7F6Egit" tabindex="-1"><a class="header-anchor" href="#_3-1\u914D\u7F6Egit" aria-hidden="true">#</a> 3.1\u914D\u7F6Egit</h2><p>\u5728jenkins\u7BA1\u7406\u754C\u9762\uFF0C\u70B9\u51FB<code>Manage Jenkins</code>\uFF0C\u9009\u62E9<code>Global Tool Configuration</code>\uFF0C\u627E\u5230<code>Git</code>\uFF0C\u70B9\u51FB<code>Add Git</code>\uFF0C\u5BF9git\u8FDB\u884C\u914D\u7F6E\u3002</p><p><img src="'+e+'" alt="1614743317137"></p><h2 id="_3-2\u914D\u7F6Edocker" tabindex="-1"><a class="header-anchor" href="#_3-2\u914D\u7F6Edocker" aria-hidden="true">#</a> 3.2\u914D\u7F6Edocker</h2><h3 id="_3-2-1docker\u57FA\u672C\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_3-2-1docker\u57FA\u672C\u914D\u7F6E" aria-hidden="true">#</a> 3.2.1docker\u57FA\u672C\u914D\u7F6E</h3><p><img src="'+t+'" alt="1614843920373"></p><h3 id="_3-2-2docker\u914D\u7F6E\u5931\u8D25\u7684\u89E3\u51B3\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_3-2-2docker\u914D\u7F6E\u5931\u8D25\u7684\u89E3\u51B3\u65B9\u6CD5" aria-hidden="true">#</a> 3.2.2docker\u914D\u7F6E\u5931\u8D25\u7684\u89E3\u51B3\u65B9\u6CD5</h3><p>\u5982\u679C\u70B9\u51FB\u3010Test Connection\u3011\u6309\u94AE\u62A5\u5982\u4E0B\u9519\u8BEF\uFF0C\u53EF\u6309\u7167\u4EE5\u4E0B\u6B65\u9AA4\u89E3\u51B3\u3002</p><p>\u62A5\u9519\u5982\u4E0B\uFF1A</p><p><img src="'+o+'" alt="1614844086777"></p><p>\u89E3\u51B3\u6B65\u9AA4\uFF1A</p><p><strong>Step1.\u8F93\u5165<code>systemctl status docker</code>\u67E5\u770Bdocker\u7AEF\u53E3\u53F7</strong></p><p><img src="'+i+`" alt="1614844258679"></p><p><strong>Step2. \u4FEE\u6539docker tcp\u7AEF\u53E3\u53F7</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">vim</span> /usr/lib/systemd/system/docker.service
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+p+`" alt="1614844441143"></p><p><strong>Step3.\u91CD\u542Fdocker</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>systemctl daemon-reload
systemctl restart <span class="token function">docker</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="`+r+'" alt="161484499599"></p><p><strong>Step4.jenkins\u6D4B\u8BD5\u662F\u5426\u8FDE\u63A5\u6210\u529F</strong></p><p><img src="'+c+'" alt="1614844727424"></p><h1 id="_4-\u521B\u5EFA\u9879\u76EE" tabindex="-1"><a class="header-anchor" href="#_4-\u521B\u5EFA\u9879\u76EE" aria-hidden="true">#</a> 4.\u521B\u5EFA\u9879\u76EE</h1><h2 id="_4-1-\u65B0\u5EFAitem" tabindex="-1"><a class="header-anchor" href="#_4-1-\u65B0\u5EFAitem" aria-hidden="true">#</a> 4.1 \u65B0\u5EFAItem</h2><p><img src="'+l+'" alt="1614821818967"></p><h2 id="_4-2\u9879\u76EE\u6E90\u7801\u8BBE\u7F6E" tabindex="-1"><a class="header-anchor" href="#_4-2\u9879\u76EE\u6E90\u7801\u8BBE\u7F6E" aria-hidden="true">#</a> 4.2\u9879\u76EE\u6E90\u7801\u8BBE\u7F6E</h2><p><img src="'+d+'" alt="1614828619072"></p><h2 id="_4-3-\u6784\u5EFA\u89E6\u53D1\u5668" tabindex="-1"><a class="header-anchor" href="#_4-3-\u6784\u5EFA\u89E6\u53D1\u5668" aria-hidden="true">#</a> 4.3 \u6784\u5EFA\u89E6\u53D1\u5668</h2><p><img src="'+h+'" alt="1614828848872"></p><h2 id="_4-4\u7F16\u5199\u6784\u5EFA\u811A\u672C" tabindex="-1"><a class="header-anchor" href="#_4-4\u7F16\u5199\u6784\u5EFA\u811A\u672C" aria-hidden="true">#</a> 4.4\u7F16\u5199\u6784\u5EFA\u811A\u672C</h2><p><img src="'+u+`" alt="1614829216956"></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token assign-left variable">pro_version</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">git</span> log <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $1}&#39;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $2}&#39;</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span> -c <span class="token operator">|</span> <span class="token function">sort</span> -k1,1nr<span class="token variable">)</span></span>
<span class="token assign-left variable">pro_image</span><span class="token operator">=</span><span class="token number">10.1</span>.93.164:5000/python-test:v<span class="token variable">\${pro_version<span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">/</span>}</span>
<span class="token function">docker</span> build -t <span class="token variable">\${pro_image}</span> <span class="token builtin class-name">.</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;-------------------------\u955C\u50CFbuild\u6210\u529F\uFF1F&quot;</span> <span class="token variable">$?</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
    <span class="token function">docker</span> push <span class="token variable">\${pro_image}</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;-------------------------\u955C\u50CFpush\u6210\u529F\uFF1F&quot;</span> <span class="token variable">$?</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">]</span>
    <span class="token keyword">then</span>
        <span class="token assign-left variable">update_image_cmd</span><span class="token operator">=</span><span class="token string">&quot;kubectl patch deployment test1 -n tth-test --patch &#39;{<span class="token entity" title="\\&quot;">\\&quot;</span>spec<span class="token entity" title="\\&quot;">\\&quot;</span>: {<span class="token entity" title="\\&quot;">\\&quot;</span>template<span class="token entity" title="\\&quot;">\\&quot;</span>: {<span class="token entity" title="\\&quot;">\\&quot;</span>spec<span class="token entity" title="\\&quot;">\\&quot;</span>: {<span class="token entity" title="\\&quot;">\\&quot;</span>containers<span class="token entity" title="\\&quot;">\\&quot;</span>: [{<span class="token entity" title="\\&quot;">\\&quot;</span>name<span class="token entity" title="\\&quot;">\\&quot;</span>: <span class="token entity" title="\\&quot;">\\&quot;</span>test1-c<span class="token entity" title="\\&quot;">\\&quot;</span>,<span class="token entity" title="\\&quot;">\\&quot;</span>image<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">\${pro_image}</span><span class="token entity" title="\\&quot;">\\&quot;</span>}]}}}}&#39;&quot;</span>
        <span class="token builtin class-name">echo</span> 
        <span class="token function">ssh</span> root@10.1.93.160 <span class="token variable">\${update_image_cmd}</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;-------------------------\u670D\u52A1\u5347\u7EA7\u6210\u529F\uFF1F&quot;</span> <span class="token variable">$?</span>
    <span class="token keyword">fi</span>
<span class="token keyword">fi</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_4-5\u4FDD\u5B58\u9879\u76EE\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#_4-5\u4FDD\u5B58\u9879\u76EE\u4FE1\u606F" aria-hidden="true">#</a> 4.5\u4FDD\u5B58\u9879\u76EE\u4FE1\u606F</h2><p>\u9879\u76EE\u4FE1\u606F\u7F16\u5199\u5B8C\u6210\u540E\uFF0C\u70B9\u51FB\u3010\u4FDD\u5B58\u3011\u6309\u94AE\u5373\u53EF\u3002</p><p><img src="`+k+'" alt="1614829313001"></p><h1 id="_5-\u90E8\u7F72\u9879\u76EE" tabindex="-1"><a class="header-anchor" href="#_5-\u90E8\u7F72\u9879\u76EE" aria-hidden="true">#</a> 5.\u90E8\u7F72\u9879\u76EE</h1><h2 id="_5-1-\u8FD0\u884C" tabindex="-1"><a class="header-anchor" href="#_5-1-\u8FD0\u884C" aria-hidden="true">#</a> 5.1 \u8FD0\u884C</h2><p><img src="'+b+'" alt="1614829530686"></p><h2 id="_5-2\u67E5\u770B\u9879\u76EE\u6784\u5EFA\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_5-2\u67E5\u770B\u9879\u76EE\u6784\u5EFA\u65E5\u5FD7" aria-hidden="true">#</a> 5.2\u67E5\u770B\u9879\u76EE\u6784\u5EFA\u65E5\u5FD7</h2><p><img src="'+g+'" alt=""></p>',50);function I(_,y){return f}var A=s(m,[["render",I],["__file","auto.html.vue"]]);export{A as default};
